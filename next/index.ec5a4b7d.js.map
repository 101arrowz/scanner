{"mappings":"IGgDI,E,S,E,C,C,C,C,C,C,C,E,O,c,C,E,E,C,I,E,I,E,W,C,E,a,C,C,E,C,S,E,C,E,O,G,E,U,C,E,O,C,C,C,I,E,A,a,O,W,W,A,a,O,K,K,A,a,O,O,O,A,a,O,O,O,C,E,E,C,E,E,C,E,E,E,iB,A,O,I,A,C,E,S,C,E,G,K,E,O,C,C,E,C,O,C,G,K,E,C,I,E,C,C,E,A,Q,C,C,E,C,I,E,C,G,E,Q,C,C,E,O,C,C,E,C,E,E,I,C,E,O,C,E,E,O,E,E,O,A,C,I,E,A,M,uB,E,I,O,E,I,C,mB,C,C,E,Q,C,S,C,C,C,E,C,C,E,C,C,E,E,iB,C,G,E,Q,C,Q,S,C,C,C,E,E,E,O,C,W,I,E,A,G,E,G,E,E,O,C,U,I,E,A,G,E,GF9CJ,IAcA,EACA,EAfI,EAAU,CAAC,EAcf,EAbA,SAAkB,CAAK,EAErB,IAAK,IADD,EAAO,OAAO,IAAA,CAAK,GACd,EAAI,EAAG,EAAI,EAAK,MAAA,CAAQ,IAC/B,CAAO,CAAC,CAAI,CAAC,EAAE,CAAC,CAAG,CAAK,CAAC,CAAI,CAAC,EAAE,CAAC,AAErC,EASA,EARA,SAAiB,CAAE,EACjB,IAAI,EAAW,CAAO,CAAC,EAAG,CAC1B,GAAI,AAAY,MAAZ,EACF,MAAM,AAAI,MAAM,oCAAsC,GAExD,OAAO,CACT,C,GCfA,AAAA,EAAA,SAAA,QAAA,CAA8C,KAAK,KAAA,CAAM,6S,I,E,C,E,E,C,EIEzD,EAAiB,SAAU,CAAS,CAAE,CAAM,CAAE,CAAK,EACjD,GAAI,IAAW,KAAK,QAAA,CAAS,MAAA,CAE3B,mCAAmC;AACnC,OAAO,CAEP,oFAAmF;AACnF,IAAI,EAAS,EAAQ,UAAY,KAAK,SAAA,CAAU,GAAa,IAAM,iBAAmB,KAAK,SAAA,CAAU,GAAa,KAClH,OAAO,IAAI,eAAA,CAAgB,IAAI,KAAK,CAAC,EAAO,CAAE,CAC5C,KAAM,wBACR,GAEJ,EDbA,IAAI,EAAA,IAAA,IAA0B,AAAA,EAAA,SAAA,OAAA,CAA6C,SAA3E,YAAA,GAAA,EACA,EAAiB,EAAU,EAAI,QAAA,GAAY,EAAI,MAAA,CAAQ,CAAA,GDAvD,MAAM,EAAY,IAAM,IAA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","sources":["<anon>","node_modules/@parcel/runtime-js/lib/helpers/bundle-manifest.js","node_modules/@parcel/runtime-js/lib/runtime-8f64662576873ef2.js","src/index.ts","src/process.ts","node_modules/@parcel/runtime-js/lib/runtime-ccd27c5d08620186.js","node_modules/@parcel/runtime-js/lib/helpers/get-worker-url.js","src/pdf.ts","src/io.ts","node_modules/@parcel/runtime-js/lib/runtime-3c0ae5d1b715ee45.js","node_modules/@parcel/runtime-js/lib/runtime-7e7584ef87de7c87.js","node_modules/@parcel/runtime-js/lib/runtime-682523936f512701.js","node_modules/@parcel/runtime-js/lib/runtime-6f1467821f42f99c.js","node_modules/image-capture/src/imagecapture.js","node_modules/@parcel/runtime-js/lib/runtime-fac40f892a0ee271.js"],"sourcesContent":["function $parcel$export(e, n, v, s) {\n  Object.defineProperty(e, n, {get: v, set: s, enumerable: true, configurable: true});\n}\nfunction $parcel$interopDefault(a) {\n  return a && a.__esModule ? a.default : a;\n}\nvar $parcel$global =\ntypeof globalThis !== 'undefined'\n  ? globalThis\n  : typeof self !== 'undefined'\n  ? self\n  : typeof window !== 'undefined'\n  ? window\n  : typeof global !== 'undefined'\n  ? global\n  : {};\nvar $parcel$modules = {};\nvar $parcel$inits = {};\n\nvar parcelRequire = $parcel$global[\"parcelRequireed96\"];\nif (parcelRequire == null) {\n  parcelRequire = function(id) {\n    if (id in $parcel$modules) {\n      return $parcel$modules[id].exports;\n    }\n    if (id in $parcel$inits) {\n      var init = $parcel$inits[id];\n      delete $parcel$inits[id];\n      var module = {id: id, exports: {}};\n      $parcel$modules[id] = module;\n      init.call(module.exports, module, module.exports);\n      return module.exports;\n    }\n    var err = new Error(\"Cannot find module '\" + id + \"'\");\n    err.code = 'MODULE_NOT_FOUND';\n    throw err;\n  };\n\n  parcelRequire.register = function register(id, init) {\n    $parcel$inits[id] = init;\n  };\n\n  $parcel$global[\"parcelRequireed96\"] = parcelRequire;\n}\nparcelRequire.register(\"27Lyk\", function(module, exports) {\n\n$parcel$export(module.exports, \"register\", () => $18c11f3350a906ea$export$6503ec6e8aabbaf, (v) => $18c11f3350a906ea$export$6503ec6e8aabbaf = v);\n$parcel$export(module.exports, \"resolve\", () => $18c11f3350a906ea$export$f7ad0328861e2f03, (v) => $18c11f3350a906ea$export$f7ad0328861e2f03 = v);\nvar $18c11f3350a906ea$export$6503ec6e8aabbaf;\nvar $18c11f3350a906ea$export$f7ad0328861e2f03;\n\"use strict\";\nvar $18c11f3350a906ea$var$mapping = {};\nfunction $18c11f3350a906ea$var$register(pairs) {\n    var keys = Object.keys(pairs);\n    for(var i = 0; i < keys.length; i++)$18c11f3350a906ea$var$mapping[keys[i]] = pairs[keys[i]];\n}\nfunction $18c11f3350a906ea$var$resolve(id) {\n    var resolved = $18c11f3350a906ea$var$mapping[id];\n    if (resolved == null) throw new Error(\"Could not resolve bundle with id \" + id);\n    return resolved;\n}\n$18c11f3350a906ea$export$6503ec6e8aabbaf = $18c11f3350a906ea$var$register;\n$18c11f3350a906ea$export$f7ad0328861e2f03 = $18c11f3350a906ea$var$resolve;\n\n});\n\nvar $a5d90bf4f39bc487$exports = {};\n\n(parcelRequire(\"27Lyk\")).register(JSON.parse('{\"1LzKV\":\"index.ec5a4b7d.js\",\"a2Cve\":\"process.8010e3f6.js\",\"bj76Q\":\"flash.7ae5cfb8.svg\",\"e0Dy9\":\"flash-off.f95884b2.svg\",\"lX2gi\":\"hd.0cfe4ff9.svg\",\"gltHY\":\"sd.25c2f123.svg\",\"drXuR\":\"service.js\"}'));\n\nvar $c75b7671c945b972$exports = {};\nvar $56b621a6dd25b2cb$exports = {};\n\"use strict\";\n$56b621a6dd25b2cb$exports = function(workerUrl, origin, isESM) {\n    if (origin === self.location.origin) // If the worker bundle's url is on the same origin as the document,\n    // use the worker bundle's own url.\n    return workerUrl;\n    else {\n        // Otherwise, create a blob URL which loads the worker bundle with `importScripts`.\n        var source = isESM ? \"import \" + JSON.stringify(workerUrl) + \";\" : \"importScripts(\" + JSON.stringify(workerUrl) + \");\";\n        return URL.createObjectURL(new Blob([\n            source\n        ], {\n            type: \"application/javascript\"\n        }));\n    }\n};\n\n\n\nlet $c75b7671c945b972$var$url = new URL((parcelRequire(\"27Lyk\")).resolve(\"a2Cve\"), import.meta.url);\n$c75b7671c945b972$exports = $56b621a6dd25b2cb$exports($c75b7671c945b972$var$url.toString(), $c75b7671c945b972$var$url.origin, true);\n\n\nconst $191e7775e3189472$var$newWorker = ()=>new Worker($c75b7671c945b972$exports);\nconst $191e7775e3189472$var$processWorkers = [];\nif (navigator.hardwareConcurrency) for(let i = 1; i < navigator.hardwareConcurrency; ++i)$191e7775e3189472$var$processWorkers.push($191e7775e3189472$var$newWorker());\nconst $191e7775e3189472$var$getWorker = ()=>$191e7775e3189472$var$processWorkers.pop() || $191e7775e3189472$var$newWorker();\nconst $191e7775e3189472$var$returnWorker = (worker)=>$191e7775e3189472$var$processWorkers.push(worker);\nlet $191e7775e3189472$var$messageID = 0;\nconst $191e7775e3189472$var$message = async (msg, transfer)=>{\n    return new Promise((resolve, reject)=>{\n        const worker = $191e7775e3189472$var$getWorker();\n        let id = $191e7775e3189472$var$messageID++;\n        // const ts = performance.now();\n        const onMessage = (evt)=>{\n            const { id: mid, error: error, result: result } = evt.data;\n            if (mid == id) {\n                if (error) {\n                    let err = new Error(error.message);\n                    err.stack = error.stack;\n                    err.name = error.name;\n                    reject(err);\n                } else resolve(result);\n                // console.log('Processed', msg, 'in', (performance.now() - ts) + 'ms', { result, error });\n                $191e7775e3189472$var$returnWorker(worker);\n                worker.removeEventListener(\"message\", onMessage);\n            }\n        };\n        worker.addEventListener(\"message\", onMessage);\n        worker.postMessage({\n            id: id,\n            msg: msg\n        }, transfer || []);\n    });\n};\nfunction $191e7775e3189472$export$c5fefc891e91de4b(data, transfer) {\n    return $191e7775e3189472$var$message({\n        type: \"find-document\",\n        data: data\n    }, transfer ? [\n        data.data.buffer\n    ] : []);\n}\nfunction $191e7775e3189472$export$ab8ba24d4c0c8986(data, region, targetWidth, transfer) {\n    return $191e7775e3189472$var$message({\n        type: \"extract-document\",\n        data: data,\n        region: region,\n        targetWidth: targetWidth\n    }, transfer ? [\n        data.data.buffer\n    ] : []);\n}\nfunction $191e7775e3189472$export$6806abd6abc725de(bitmap, transfer) {\n    return $191e7775e3189472$var$message({\n        type: \"get-data\",\n        bitmap: bitmap\n    }, transfer ? [\n        bitmap\n    ] : []);\n}\n\n\nconst $98ce8732f7dffb75$var$readFile = Blob.prototype.arrayBuffer || function() {\n    return new Promise((resolve, reject)=>{\n        const fr = new FileReader();\n        fr.onload = ()=>{\n            resolve(fr.result);\n        };\n        fr.onerror = ()=>{\n            reject(fr.error);\n        };\n        fr.readAsArrayBuffer(this);\n    });\n};\nconst $98ce8732f7dffb75$export$99fdcdff3bb1ad24 = async (images)=>{\n    const pdfChunks = [];\n    let index = 0;\n    const offsets = [];\n    const write = (chunk)=>{\n        pdfChunks.push(chunk);\n        index += chunk.length;\n    };\n    const token = (chunk)=>{\n        write(\" \");\n        write(chunk);\n    };\n    const concat = (chunks)=>{\n        let len = 0;\n        for (const chunk of chunks)len += chunk.length;\n        const buf = new Uint8Array(len);\n        len = 0;\n        for (const chunk of chunks){\n            if (typeof chunk == \"string\") for(let i = 0; i < chunk.length; ++i)buf[i + len] = chunk.charCodeAt(i);\n            else buf.set(chunk, len);\n            len += chunk.length;\n        }\n        return buf;\n    };\n    // Convenience functions\n    const comment = (content)=>{\n        write(\"%\" + content + \"\\n\");\n    };\n    const number = (value)=>{\n        // Note: this doesnt work for very small and very large numbers\n        token(value.toString());\n    };\n    const ascii = (value)=>{\n        token(\"(\" + value.replace(/[\\n\\r\\t\\f\\b\\(\\)\\\\]/g, (c)=>\"\\\\00\" + c.charCodeAt(0).toString(8)) + \")\");\n    };\n    const bin = (value)=>{\n        let data = \"<\";\n        if (typeof value == \"string\") for(let i = 0; i < value.length; ++i)data += value.charCodeAt(i).toString(16);\n        else for(let i = 0; i < value.length; ++i)data += value[i].toString(16);\n        token(data + \">\");\n    };\n    const name = (value)=>{\n        // Note: only supports ASCII names\n        token(\"/\" + value);\n    };\n    const array = (fn)=>{\n        token(\"[\");\n        fn();\n        token(\"]\");\n    };\n    const dict = (values)=>{\n        token(\"<<\");\n        for(const key in values){\n            name(key);\n            values[key]();\n        }\n        token(\">>\");\n    };\n    const stream = (desc, content)=>{\n        dict(desc);\n        token(\"stream\\n\");\n        write(content);\n        write(\"endstream\");\n    };\n    const object = (fn)=>{\n        write(\" \");\n        write(offsets.push(index) + \" 0 obj\");\n        fn();\n        token(\"endobj\");\n        return offsets.length;\n    };\n    const reference = (id)=>{\n        token(id + \" 0 R\");\n    };\n    const nullObject = ()=>{\n        token(\"null\");\n    };\n    // v1.4 for compatibility\n    comment(\"PDF-1.4\");\n    // 4 byte binary comment, as suggested by spec\n    comment(\"\\x90\\x85\\xfa\\xe3\");\n    const pages = await Promise.all(images.map(async (img)=>{\n        const canvas = document.createElement(\"canvas\");\n        canvas.width = img.width;\n        canvas.height = img.height;\n        canvas.getContext(\"2d\").putImageData(img, 0, 0);\n        const jpeg = await new Promise((resolve)=>canvas.toBlob(resolve, \"image/jpeg\"));\n        const jpegData = new Uint8Array(await $98ce8732f7dffb75$var$readFile.call(jpeg));\n        const image = object(()=>{\n            stream({\n                Type () {\n                    name(\"XObject\");\n                },\n                Subtype () {\n                    name(\"Image\");\n                },\n                Width () {\n                    number(img.width);\n                },\n                Height () {\n                    number(img.height);\n                },\n                ColorSpace () {\n                    name(\"DeviceRGB\");\n                },\n                BitsPerComponent () {\n                    number(8);\n                },\n                Filter () {\n                    name(\"DCTDecode\");\n                },\n                Length () {\n                    number(jpegData.length);\n                }\n            }, jpegData);\n        });\n        // US Letter width\n        const height = 792;\n        const width = height * img.width / img.height;\n        const contents = object(()=>{\n            const result = `${width} 0 0 ${height} 0 0 cm /I Do`;\n            stream({\n                Length () {\n                    number(result.length);\n                }\n            }, concat([\n                result\n            ]));\n        });\n        const page = object(()=>{\n            dict({\n                Type () {\n                    name(\"Page\");\n                },\n                Parent () {\n                    reference(offsets.length + 1);\n                },\n                Resources () {\n                    dict({\n                        XObject () {\n                            dict({\n                                I () {\n                                    reference(image);\n                                }\n                            });\n                        }\n                    });\n                },\n                Contents () {\n                    reference(contents);\n                },\n                MediaBox () {\n                    array(()=>{\n                        number(0);\n                        number(0);\n                        number(width);\n                        number(height);\n                    });\n                }\n            });\n        });\n        return page;\n    }));\n    const pageRoot = object(()=>{\n        dict({\n            Type () {\n                name(\"Pages\");\n            },\n            Kids () {\n                array(()=>{\n                    for (const page of pages)reference(page);\n                });\n            },\n            Count () {\n                number(pages.length);\n            }\n        });\n    });\n    const catalog = object(()=>{\n        dict({\n            Type () {\n                name(\"Catalog\");\n            },\n            Pages () {\n                reference(pageRoot);\n            }\n        });\n    });\n    // XREF\n    write(\"\\n\");\n    const xrefOffset = index;\n    write(\"xref\\n0 \" + (offsets.length + 1) + \"\\n0000000000 65535 f \\n\");\n    for (const offset of offsets)write(offset.toString().padStart(10, \"0\") + \" 00000 n \\n\");\n    write(\"trailer\");\n    dict({\n        Size () {\n            number(offsets.length + 1);\n        },\n        Root () {\n            reference(catalog);\n        }\n    });\n    write(\"\\nstartxref\\n\" + xrefOffset + \"\\n%%EOF\");\n    return concat(pdfChunks);\n};\n\n\n\nconst $aa7f0fbc084e0a0e$export$85ada9a21afbeab6 = async (img)=>{\n    const elem = document.createElement(\"img\");\n    const loaded = new Promise((resolve, reject)=>{\n        elem.onload = ()=>{\n            resolve();\n        };\n        elem.onerror = (err)=>{\n            reject(err);\n        };\n    });\n    elem.src = URL.createObjectURL(img);\n    await loaded;\n    URL.revokeObjectURL(elem.src);\n    return elem;\n};\nconst $aa7f0fbc084e0a0e$var$sharedCanvas = document.createElement(\"canvas\");\nconst $aa7f0fbc084e0a0e$var$sharedCtx = $aa7f0fbc084e0a0e$var$sharedCanvas.getContext(\"2d\");\nconst $aa7f0fbc084e0a0e$export$7a171f172be0782e = async (img, transfer)=>{\n    if ($aa7f0fbc084e0a0e$var$sharedCanvas[\"transferControlToOffscreen\"]) return (0, $191e7775e3189472$export$6806abd6abc725de)(img instanceof ImageBitmap ? img : await createImageBitmap(img), transfer);\n    $aa7f0fbc084e0a0e$var$sharedCanvas.width = img.width, $aa7f0fbc084e0a0e$var$sharedCanvas.height = img.height;\n    $aa7f0fbc084e0a0e$var$sharedCtx.drawImage(img, 0, 0);\n    return $aa7f0fbc084e0a0e$var$sharedCtx.getImageData(0, 0, img.width, img.height);\n};\nconst $aa7f0fbc084e0a0e$export$24422be91ad4011f = (file, name)=>{\n    const url = URL.createObjectURL(file);\n    const el = document.createElement(\"a\");\n    el.download = name;\n    el.href = url;\n    el.click();\n    URL.revokeObjectURL(url);\n};\n\n\nvar $5680d29e5f9eab67$exports = {};\n\n$5680d29e5f9eab67$exports = new URL((parcelRequire(\"27Lyk\")).resolve(\"bj76Q\"), import.meta.url).toString();\n\n\nvar $bb74cf2efca2bea5$exports = {};\n\n$bb74cf2efca2bea5$exports = new URL((parcelRequire(\"27Lyk\")).resolve(\"e0Dy9\"), import.meta.url).toString();\n\n\nvar $009ec47ee18c0b40$exports = {};\n\n$009ec47ee18c0b40$exports = new URL((parcelRequire(\"27Lyk\")).resolve(\"lX2gi\"), import.meta.url).toString();\n\n\nvar $954630f75b1da243$exports = {};\n\n$954630f75b1da243$exports = new URL((parcelRequire(\"27Lyk\")).resolve(\"gltHY\"), import.meta.url).toString();\n\n\n/**\n * MediaStream ImageCapture polyfill\n *\n * @license\n * Copyright 2018 Google Inc.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */ let $0e4bd8b916ae6e46$export$d2caa7debd66c3ef = window.ImageCapture;\nif (typeof $0e4bd8b916ae6e46$export$d2caa7debd66c3ef === \"undefined\") $0e4bd8b916ae6e46$export$d2caa7debd66c3ef = class {\n    /**\n     * TODO https://www.w3.org/TR/image-capture/#constructors\n     *\n     * @param {MediaStreamTrack} videoStreamTrack - A MediaStreamTrack of the 'video' kind\n     */ constructor(videoStreamTrack){\n        if (videoStreamTrack.kind !== \"video\") throw new DOMException(\"NotSupportedError\");\n        this._videoStreamTrack = videoStreamTrack;\n        if (!(\"readyState\" in this._videoStreamTrack)) // Polyfill for Firefox\n        this._videoStreamTrack.readyState = \"live\";\n        // MediaStream constructor not available until Chrome 55 - https://www.chromestatus.com/feature/5912172546752512\n        this._previewStream = new MediaStream([\n            videoStreamTrack\n        ]);\n        this.videoElement = document.createElement(\"video\");\n        this.videoElementPlaying = new Promise((resolve)=>{\n            this.videoElement.addEventListener(\"playing\", resolve);\n        });\n        if (HTMLMediaElement) this.videoElement.srcObject = this._previewStream; // Safari 11 doesn't allow use of createObjectURL for MediaStream\n        else this.videoElement.src = URL.createObjectURL(this._previewStream);\n        this.videoElement.muted = true;\n        this.videoElement.setAttribute(\"playsinline\", \"\"); // Required by Safari on iOS 11. See https://webkit.org/blog/6784\n        this.videoElement.play();\n        this.canvasElement = document.createElement(\"canvas\");\n        // TODO Firefox has https://developer.mozilla.org/en-US/docs/Web/API/OffscreenCanvas\n        this.canvas2dContext = this.canvasElement.getContext(\"2d\");\n    }\n    /**\n     * https://w3c.github.io/mediacapture-image/index.html#dom-imagecapture-videostreamtrack\n     * @return {MediaStreamTrack} The MediaStreamTrack passed into the constructor\n     */ get videoStreamTrack() {\n        return this._videoStreamTrack;\n    }\n    /**\n     * Implements https://www.w3.org/TR/image-capture/#dom-imagecapture-getphotocapabilities\n     * @return {Promise<PhotoCapabilities>} Fulfilled promise with\n     * [PhotoCapabilities](https://www.w3.org/TR/image-capture/#idl-def-photocapabilities)\n     * object on success, rejected promise on failure\n     */ getPhotoCapabilities() {\n        return new Promise(function executorGPC(resolve, reject) {\n            // TODO see https://github.com/w3c/mediacapture-image/issues/97\n            const MediaSettingsRange = {\n                current: 0,\n                min: 0,\n                max: 0\n            };\n            resolve({\n                exposureCompensation: MediaSettingsRange,\n                exposureMode: \"none\",\n                fillLightMode: \"none\",\n                focusMode: \"none\",\n                imageHeight: MediaSettingsRange,\n                imageWidth: MediaSettingsRange,\n                iso: MediaSettingsRange,\n                redEyeReduction: false,\n                whiteBalanceMode: \"none\",\n                zoom: MediaSettingsRange\n            });\n            reject(new DOMException(\"OperationError\"));\n        });\n    }\n    /**\n     * Implements https://www.w3.org/TR/image-capture/#dom-imagecapture-setoptions\n     * @param {Object} photoSettings - Photo settings dictionary, https://www.w3.org/TR/image-capture/#idl-def-photosettings\n     * @return {Promise<void>} Fulfilled promise on success, rejected promise on failure\n     */ setOptions(photoSettings = {}) {\n        return new Promise(function executorSO(resolve, reject) {\n        // TODO\n        });\n    }\n    /**\n     * TODO\n     * Implements https://www.w3.org/TR/image-capture/#dom-imagecapture-takephoto\n     * @return {Promise<Blob>} Fulfilled promise with [Blob](https://www.w3.org/TR/FileAPI/#blob)\n     * argument on success; rejected promise on failure\n     */ takePhoto() {\n        const self = this;\n        return new Promise(function executorTP(resolve, reject) {\n            // `If the readyState of the MediaStreamTrack provided in the constructor is not live,\n            // return a promise rejected with a new DOMException whose name is \"InvalidStateError\".`\n            if (self._videoStreamTrack.readyState !== \"live\") return reject(new DOMException(\"InvalidStateError\"));\n            self.videoElementPlaying.then(()=>{\n                try {\n                    self.canvasElement.width = self.videoElement.videoWidth;\n                    self.canvasElement.height = self.videoElement.videoHeight;\n                    self.canvas2dContext.drawImage(self.videoElement, 0, 0);\n                    self.canvasElement.toBlob(resolve);\n                } catch (error) {\n                    reject(new DOMException(\"UnknownError\"));\n                }\n            });\n        });\n    }\n    /**\n     * Implements https://www.w3.org/TR/image-capture/#dom-imagecapture-grabframe\n     * @return {Promise<ImageBitmap>} Fulfilled promise with\n     * [ImageBitmap](https://www.w3.org/TR/html51/webappapis.html#webappapis-images)\n     * argument on success; rejected promise on failure\n     */ grabFrame() {\n        const self = this;\n        return new Promise(function executorGF(resolve, reject) {\n            // `If the readyState of the MediaStreamTrack provided in the constructor is not live,\n            // return a promise rejected with a new DOMException whose name is \"InvalidStateError\".`\n            if (self._videoStreamTrack.readyState !== \"live\") return reject(new DOMException(\"InvalidStateError\"));\n            self.videoElementPlaying.then(()=>{\n                try {\n                    self.canvasElement.width = self.videoElement.videoWidth;\n                    self.canvasElement.height = self.videoElement.videoHeight;\n                    self.canvas2dContext.drawImage(self.videoElement, 0, 0);\n                    // TODO polyfill https://developer.mozilla.org/en-US/docs/Web/API/ImageBitmapFactories/createImageBitmap for IE\n                    resolve(window.createImageBitmap(self.canvasElement));\n                } catch (error) {\n                    reject(new DOMException(\"UnknownError\"));\n                }\n            });\n        });\n    }\n};\nwindow.ImageCapture = $0e4bd8b916ae6e46$export$d2caa7debd66c3ef;\n\n\nconst $b4e14b6b8da86996$var$root = document.getElementById(\"root\");\nconst $b4e14b6b8da86996$var$modal = document.getElementById(\"modal\");\nconst $b4e14b6b8da86996$var$captures = document.getElementById(\"captures\");\nconst $b4e14b6b8da86996$var$preview = document.getElementById(\"preview\");\nconst $b4e14b6b8da86996$var$previewCrop = document.getElementById(\"preview-crop\");\nconst $b4e14b6b8da86996$var$previewDoc = document.getElementById(\"preview-doc\");\nconst $b4e14b6b8da86996$var$bottomWrapper = document.getElementById(\"bottom-wrapper\");\nconst $b4e14b6b8da86996$var$topWrapper = document.getElementById(\"top-wrapper\");\nconst $b4e14b6b8da86996$var$selectWrapper = document.getElementById(\"camera-select-wrapper\");\nconst $b4e14b6b8da86996$var$select = document.getElementById(\"camera-select\");\nconst $b4e14b6b8da86996$var$qualityWrapper = document.getElementById(\"quality-wrapper\");\nconst $b4e14b6b8da86996$var$quality = document.getElementById(\"quality\");\nconst $b4e14b6b8da86996$var$qualityImg = document.getElementById(\"quality-img\");\nconst $b4e14b6b8da86996$var$githubWrapper = document.getElementById(\"github-wrapper\");\nconst $b4e14b6b8da86996$var$flashWrapper = document.getElementById(\"flash-wrapper\");\nconst $b4e14b6b8da86996$var$flash = document.getElementById(\"flash\");\nconst $b4e14b6b8da86996$var$flashImg = document.getElementById(\"flash-img\");\nconst $b4e14b6b8da86996$var$pastWrapper = document.getElementById(\"past-wrapper\");\nconst $b4e14b6b8da86996$var$past = document.getElementById(\"past\");\nconst $b4e14b6b8da86996$var$uploadWrapper = document.getElementById(\"upload-wrapper\");\nconst $b4e14b6b8da86996$var$upload = document.getElementById(\"upload\");\nconst $b4e14b6b8da86996$var$shutter = document.getElementById(\"shutter\");\nconst $b4e14b6b8da86996$var$doneWrapper = document.getElementById(\"done-wrapper\");\nconst $b4e14b6b8da86996$var$done = document.getElementById(\"done\");\nconst $b4e14b6b8da86996$var$modalBottomWrapper = document.getElementById(\"modal-bottom-wrapper\");\nconst $b4e14b6b8da86996$var$modalCancelWrapper = document.getElementById(\"modal-cancel-wrapper\");\nconst $b4e14b6b8da86996$var$modalCancel = document.getElementById(\"modal-cancel\");\nconst $b4e14b6b8da86996$var$modalDoneWrapper = document.getElementById(\"modal-done-wrapper\");\nconst $b4e14b6b8da86996$var$modalDone = document.getElementById(\"modal-done\");\nlet $b4e14b6b8da86996$var$defaultMaxRes;\nlet $b4e14b6b8da86996$var$maxRes = {};\nconst $b4e14b6b8da86996$var$pages = [];\nconst $b4e14b6b8da86996$var$log = (text)=>{\n    const el = document.createElement(\"div\");\n    el.innerText = text;\n    $b4e14b6b8da86996$var$root.appendChild(el);\n};\nconst $b4e14b6b8da86996$var$resizeListeners = [];\nconst $b4e14b6b8da86996$var$onResize = (listener)=>{\n    $b4e14b6b8da86996$var$resizeListeners.push(listener);\n    return ()=>{\n        $b4e14b6b8da86996$var$resizeListeners.splice($b4e14b6b8da86996$var$resizeListeners.indexOf(listener), 1);\n    };\n};\nconst $b4e14b6b8da86996$var$callResizeListeners = ()=>{\n    for (const listener of $b4e14b6b8da86996$var$resizeListeners)listener();\n};\nlet $b4e14b6b8da86996$var$rst = -1;\nwindow.addEventListener(\"resize\", ()=>{\n    clearTimeout($b4e14b6b8da86996$var$rst);\n    $b4e14b6b8da86996$var$rst = setTimeout($b4e14b6b8da86996$var$callResizeListeners, 250);\n}, {\n    passive: true\n});\nconst $b4e14b6b8da86996$var$getMaxRes = (device)=>{\n    const constraints = {\n        width: 100000,\n        height: 100000,\n        facingMode: \"environment\"\n    };\n    if (device) {\n        if ($b4e14b6b8da86996$var$maxRes[device]) return $b4e14b6b8da86996$var$maxRes[device];\n        constraints.deviceId = {\n            exact: device\n        };\n    } else if ($b4e14b6b8da86996$var$defaultMaxRes) return $b4e14b6b8da86996$var$defaultMaxRes;\n    const prom = navigator.mediaDevices.getUserMedia({\n        video: constraints\n    }).then((media)=>{\n        const settings = media.getVideoTracks()[0].getSettings();\n        for (const track of media.getTracks())track.stop();\n        const width = Math.max(settings.width, settings.height);\n        const height = Math.min(settings.width, settings.height);\n        return {\n            width: width,\n            height: height,\n            deviceId: settings.deviceId\n        };\n    });\n    if (device) $b4e14b6b8da86996$var$maxRes[device] = prom;\n    else $b4e14b6b8da86996$var$defaultMaxRes = prom.then((val)=>{\n        $b4e14b6b8da86996$var$maxRes[val.deviceId] = prom;\n        return val;\n    });\n    return prom;\n};\nconst $b4e14b6b8da86996$var$point = (a, scale)=>{\n    const elem = document.createElement(\"div\");\n    const mwh = Math.min(window.innerWidth, window.innerHeight);\n    elem.style.width = mwh * 0.03 + \"px\";\n    elem.style.height = mwh * 0.03 + \"px\";\n    elem.style.borderRadius = mwh * 0.015 + \"px\";\n    elem.style.backgroundColor = \"black\";\n    elem.style.position = \"absolute\";\n    $b4e14b6b8da86996$var$adjustPoint(elem, a, scale);\n    return elem;\n};\nconst $b4e14b6b8da86996$var$adjustPoint = (elem, a, scale)=>{\n    const mwh = Math.min(window.innerWidth, window.innerHeight);\n    elem.style.top = a.y * scale - mwh * 0.015 + \"px\";\n    elem.style.left = a.x * scale - mwh * 0.015 + \"px\";\n};\nconst $b4e14b6b8da86996$var$line = (a, b, scale)=>{\n    const elem = document.createElement(\"div\");\n    elem.style.height = \"4px\";\n    elem.style.backgroundColor = \"red\";\n    elem.style.position = \"absolute\";\n    elem.style.transformOrigin = \"center left\";\n    $b4e14b6b8da86996$var$adjustLine(elem, a, b, scale);\n    return elem;\n};\nconst $b4e14b6b8da86996$var$adjustLine = (elem, a, b, scale)=>{\n    elem.style.width = Math.hypot(a.x - b.x, a.y - b.y) * scale + \"px\";\n    elem.style.top = a.y * scale + \"px\";\n    elem.style.left = a.x * scale + \"px\";\n    elem.style.transform = `rotate(${Math.atan2(b.y - a.y, b.x - a.x)}rad)`;\n};\nconst $b4e14b6b8da86996$var$preprocessPhoto = async (src)=>{\n    let img, data;\n    if (src instanceof Blob) {\n        const image = await (0, $aa7f0fbc084e0a0e$export$85ada9a21afbeab6)(src);\n        img = image;\n        data = await (0, $aa7f0fbc084e0a0e$export$7a171f172be0782e)(image);\n    } else {\n        const cnv = document.createElement(\"canvas\");\n        cnv.width = src.width;\n        cnv.height = src.height;\n        cnv.getContext(\"2d\").drawImage(src, 0, 0);\n        img = cnv;\n        data = await (0, $aa7f0fbc084e0a0e$export$7a171f172be0782e)(src, true);\n    }\n    const quad = await (0, $191e7775e3189472$export$c5fefc891e91de4b)(data) || {\n        a: {\n            x: 0,\n            y: data.height\n        },\n        b: {\n            x: 0,\n            y: 0\n        },\n        c: {\n            x: data.width,\n            y: 0\n        },\n        d: {\n            x: data.width,\n            y: data.height\n        }\n    };\n    const clampPoint = (a)=>{\n        if (a.x < 0) a.x = 0;\n        else if (a.x > data.width) a.x = data.width;\n        if (a.y < 0) a.y = 0;\n        else if (a.y > data.height) a.y = data.height;\n    };\n    clampPoint(quad.a);\n    clampPoint(quad.b);\n    clampPoint(quad.c);\n    clampPoint(quad.d);\n    return {\n        img: img,\n        data: data,\n        quad: quad\n    };\n};\nconst $b4e14b6b8da86996$var$processPhotos = async (srcs)=>{\n    const results = srcs.map((src)=>src instanceof Blob || src instanceof ImageBitmap ? $b4e14b6b8da86996$var$preprocessPhoto(src) : src);\n    const cbs = [];\n    let firstDimensions = {\n        width: 0,\n        height: 0\n    };\n    let landscape = false;\n    for (const result of results){\n        const isFirst = result == results[0];\n        const isLast = result == results[results.length - 1];\n        const { img: img, data: data, quad: quad } = await result;\n        const imgCrop = document.createElement(\"div\");\n        imgCrop.style.display = \"flex\";\n        imgCrop.style.justifyContent = \"center\";\n        imgCrop.style.alignItems = \"center\";\n        imgCrop.style.overflow = \"hidden\";\n        imgCrop.style.scrollSnapAlign = \"center\";\n        const imgDoc = document.createElement(\"div\");\n        imgDoc.style.position = \"relative\";\n        imgDoc.appendChild(img);\n        imgCrop.appendChild(imgDoc);\n        $b4e14b6b8da86996$var$modal.style.display = \"flex\";\n        const aspectRatio = Math.max(data.width, data.height) / Math.min(data.width, data.height);\n        let scale = 0, docX = 0, docY = 0, latestDims = false;\n        let prevElems = [];\n        const getLatestDims = ()=>{\n            if (!latestDims) {\n                const { left: left, top: top } = imgDoc.getBoundingClientRect();\n                docX = left;\n                docY = top;\n                latestDims = true;\n            }\n        };\n        const makePoint = (src, onUpdate)=>{\n            const pt = $b4e14b6b8da86996$var$point(src, scale);\n            let active = false;\n            const onDown = (evt, x, y)=>{\n                if (pt.parentElement == imgDoc) {\n                    if (evt.target == pt || evt.target == img && Math.hypot(x - src.x * scale, y - src.y * scale) < Math.min(window.innerWidth, window.innerHeight) * 0.2) {\n                        evt.stopImmediatePropagation();\n                        active = true;\n                        onMove(x, y);\n                    }\n                } else {\n                    imgDoc.removeEventListener(\"mousedown\", onMouseDown);\n                    imgDoc.removeEventListener(\"touchstart\", onTouchStart);\n                    imgDoc.removeEventListener(\"mousemove\", onMouseMove);\n                    imgDoc.removeEventListener(\"touchmove\", onTouchMove);\n                    imgDoc.removeEventListener(\"mouseup\", onUp);\n                    imgDoc.removeEventListener(\"touchend\", onUp);\n                }\n            };\n            const onMove = (x, y)=>{\n                src.x = x / scale;\n                src.y = y / scale;\n                $b4e14b6b8da86996$var$adjustPoint(pt, src, scale);\n                onUpdate();\n            };\n            const onUp = ()=>{\n                active = false;\n            };\n            const onMouseDown = (e)=>{\n                getLatestDims();\n                onDown(e, e.pageX - docX, e.pageY - docY);\n            };\n            imgDoc.addEventListener(\"mousedown\", onMouseDown);\n            const onTouchStart = (e)=>{\n                const touch = e.targetTouches[0];\n                getLatestDims();\n                onDown(e, touch.pageX - docX, touch.pageY - docY);\n            };\n            imgDoc.addEventListener(\"touchstart\", onTouchStart);\n            const onMouseMove = (e)=>{\n                if (active) {\n                    e.preventDefault();\n                    onMove(e.pageX - docX, e.pageY - docY);\n                }\n            };\n            imgDoc.addEventListener(\"mousemove\", onMouseMove);\n            const onTouchMove = (e)=>{\n                if (active) {\n                    const touch = e.targetTouches[0];\n                    e.preventDefault();\n                    onMove(touch.pageX - docX, touch.pageY - docY);\n                }\n            };\n            imgDoc.addEventListener(\"touchmove\", onTouchMove);\n            imgDoc.addEventListener(\"mouseup\", onUp);\n            imgDoc.addEventListener(\"touchend\", onUp);\n            return pt;\n        };\n        const paintLines = ()=>{\n            for (const elem of prevElems)imgDoc.removeChild(elem);\n            const ab = $b4e14b6b8da86996$var$line(quad.a, quad.b, scale);\n            const bc = $b4e14b6b8da86996$var$line(quad.b, quad.c, scale);\n            const cd = $b4e14b6b8da86996$var$line(quad.c, quad.d, scale);\n            const da = $b4e14b6b8da86996$var$line(quad.d, quad.a, scale);\n            prevElems = [\n                imgDoc.appendChild(ab),\n                imgDoc.appendChild(bc),\n                imgDoc.appendChild(cd),\n                imgDoc.appendChild(da),\n                imgDoc.appendChild(makePoint(quad.a, ()=>{\n                    $b4e14b6b8da86996$var$adjustLine(da, quad.d, quad.a, scale);\n                    $b4e14b6b8da86996$var$adjustLine(ab, quad.a, quad.b, scale);\n                })),\n                imgDoc.appendChild(makePoint(quad.b, ()=>{\n                    $b4e14b6b8da86996$var$adjustLine(ab, quad.a, quad.b, scale);\n                    $b4e14b6b8da86996$var$adjustLine(bc, quad.b, quad.c, scale);\n                })),\n                imgDoc.appendChild(makePoint(quad.c, ()=>{\n                    $b4e14b6b8da86996$var$adjustLine(bc, quad.b, quad.c, scale);\n                    $b4e14b6b8da86996$var$adjustLine(cd, quad.c, quad.d, scale);\n                })),\n                imgDoc.appendChild(makePoint(quad.d, ()=>{\n                    $b4e14b6b8da86996$var$adjustLine(cd, quad.c, quad.d, scale);\n                    $b4e14b6b8da86996$var$adjustLine(da, quad.d, quad.a, scale);\n                }))\n            ];\n        };\n        const updateImageDimensions = ()=>{\n            const { width: width, height: height } = isFirst ? $b4e14b6b8da86996$var$calcDimensions(aspectRatio, 0.925) : firstDimensions;\n            if (isFirst) {\n                landscape = $b4e14b6b8da86996$var$isLandscape(aspectRatio);\n                firstDimensions = {\n                    width: width,\n                    height: height\n                };\n                $b4e14b6b8da86996$var$modalCancelWrapper.style.width = $b4e14b6b8da86996$var$modalCancelWrapper.style.height = $b4e14b6b8da86996$var$modalDoneWrapper.style.width = $b4e14b6b8da86996$var$modalDoneWrapper.style.height = (landscape ? window.innerWidth : window.innerHeight) * 0.035 + \"px\";\n                $b4e14b6b8da86996$var$modalCancelWrapper.style.margin = $b4e14b6b8da86996$var$modalDoneWrapper.style.margin = (landscape ? window.innerWidth : window.innerHeight) * 0.02 + \"px\";\n                $b4e14b6b8da86996$var$captures.style.width = $b4e14b6b8da86996$var$modal.style.width = window.innerWidth + \"px\";\n                $b4e14b6b8da86996$var$captures.style.height = $b4e14b6b8da86996$var$modal.style.height = window.innerHeight + \"px\";\n                $b4e14b6b8da86996$var$modal.style.flexDirection = landscape ? \"row\" : \"column\";\n                $b4e14b6b8da86996$var$captures.style.flexDirection = landscape ? \"column\" : \"row\";\n                if (landscape) {\n                    $b4e14b6b8da86996$var$modalBottomWrapper.style.flexDirection = \"column\";\n                    $b4e14b6b8da86996$var$modalBottomWrapper.style.height = window.innerHeight + \"px\";\n                    $b4e14b6b8da86996$var$modalBottomWrapper.style.width = \"\";\n                } else {\n                    $b4e14b6b8da86996$var$modalBottomWrapper.style.flexDirection = \"row\";\n                    $b4e14b6b8da86996$var$modalBottomWrapper.style.height = \"\";\n                    $b4e14b6b8da86996$var$modalBottomWrapper.style.width = window.innerWidth + \"px\";\n                }\n            }\n            const cssWidth = width + \"px\";\n            const cssHeight = height + \"px\";\n            if (landscape) {\n                img.style.width = \"\";\n                img.style.height = cssHeight;\n                scale = window.innerHeight / data.height;\n            } else {\n                img.style.width = cssWidth;\n                img.style.height = \"\";\n                scale = window.innerWidth / data.width;\n            }\n            imgCrop.style.width = imgCrop.style.minWidth = cssWidth;\n            imgCrop.style.height = imgCrop.style.minHeight = cssHeight;\n            latestDims = false;\n            paintLines();\n        };\n        updateImageDimensions();\n        $b4e14b6b8da86996$var$captures.appendChild(imgCrop);\n        const offResize = $b4e14b6b8da86996$var$onResize(updateImageDimensions);\n        cbs.push((check)=>{\n            if (check) {\n                $b4e14b6b8da86996$var$pages.push({\n                    data: data,\n                    quad: quad,\n                    img: img\n                });\n                $b4e14b6b8da86996$var$doneWrapper.style.opacity = \"\";\n                if (isLast) {\n                    if (img.width > img.height) {\n                        img.style.height = $b4e14b6b8da86996$var$pastWrapper.style.height;\n                        img.style.width = \"\";\n                    } else {\n                        img.style.height = \"\";\n                        img.style.width = $b4e14b6b8da86996$var$pastWrapper.style.width;\n                    }\n                    while($b4e14b6b8da86996$var$pastWrapper.lastChild != $b4e14b6b8da86996$var$past)$b4e14b6b8da86996$var$pastWrapper.removeChild($b4e14b6b8da86996$var$pastWrapper.lastChild);\n                    $b4e14b6b8da86996$var$pastWrapper.appendChild(img);\n                }\n            }\n            offResize();\n            $b4e14b6b8da86996$var$captures.removeChild(imgCrop);\n        });\n    }\n    return new Promise((resolve)=>{\n        const onDone = ()=>finish(true);\n        const onCancel = ()=>finish(false);\n        $b4e14b6b8da86996$var$modalCancel.addEventListener(\"click\", onCancel);\n        $b4e14b6b8da86996$var$modalDone.addEventListener(\"click\", onDone);\n        const finish = (check)=>{\n            $b4e14b6b8da86996$var$modalDone.removeEventListener(\"click\", onDone);\n            $b4e14b6b8da86996$var$modalCancel.removeEventListener(\"click\", onCancel);\n            $b4e14b6b8da86996$var$modal.style.display = \"none\";\n            for (const cb of cbs)cb(check);\n            resolve(check);\n        };\n    });\n};\nconst $b4e14b6b8da86996$var$isLandscape = (aspectRatio)=>window.innerWidth > window.innerHeight * aspectRatio;\nconst $b4e14b6b8da86996$var$calcDimensions = (aspectRatio, maxRatio)=>{\n    const landscape = $b4e14b6b8da86996$var$isLandscape(aspectRatio);\n    const height = landscape ? window.innerHeight : Math.floor(Math.min(window.innerWidth * aspectRatio, window.innerHeight * maxRatio));\n    const width = landscape ? Math.floor(Math.min(window.innerHeight * aspectRatio, window.innerWidth * maxRatio)) : window.innerWidth;\n    return {\n        width: width,\n        height: height\n    };\n};\nconst $b4e14b6b8da86996$var$sideWrappers = [\n    $b4e14b6b8da86996$var$topWrapper,\n    $b4e14b6b8da86996$var$bottomWrapper\n];\nconst $b4e14b6b8da86996$var$topElems = [\n    $b4e14b6b8da86996$var$flashWrapper,\n    $b4e14b6b8da86996$var$qualityWrapper,\n    $b4e14b6b8da86996$var$githubWrapper,\n    $b4e14b6b8da86996$var$selectWrapper,\n    $b4e14b6b8da86996$var$pastWrapper\n];\nconst $b4e14b6b8da86996$var$bottomElems = [\n    $b4e14b6b8da86996$var$doneWrapper,\n    $b4e14b6b8da86996$var$uploadWrapper\n];\nconst $b4e14b6b8da86996$var$allElems = $b4e14b6b8da86996$var$topElems.concat($b4e14b6b8da86996$var$bottomElems, $b4e14b6b8da86996$var$shutter);\nconst $b4e14b6b8da86996$var$startStream = async (device)=>{\n    const maxRes = await $b4e14b6b8da86996$var$getMaxRes(device);\n    let aspectRatio = maxRes.width / maxRes.height;\n    const landscape = $b4e14b6b8da86996$var$isLandscape(aspectRatio);\n    const { width: width, height: height } = $b4e14b6b8da86996$var$calcDimensions(aspectRatio, 0.84);\n    const cssHeight = height + \"px\";\n    const cssWidth = width + \"px\";\n    $b4e14b6b8da86996$var$previewCrop.style.width = $b4e14b6b8da86996$var$previewCrop.style.minWidth = cssWidth;\n    $b4e14b6b8da86996$var$previewCrop.style.height = $b4e14b6b8da86996$var$previewCrop.style.minHeight = cssHeight;\n    $b4e14b6b8da86996$var$root.style.width = window.innerWidth + \"px\";\n    $b4e14b6b8da86996$var$root.style.height = window.innerHeight + \"px\";\n    for (const sideWrapper of $b4e14b6b8da86996$var$sideWrappers)if (landscape) {\n        sideWrapper.style.flexDirection = \"column\";\n        sideWrapper.style.height = window.innerHeight + \"px\";\n        sideWrapper.style.width = \"\";\n    } else {\n        sideWrapper.style.flexDirection = \"row\";\n        sideWrapper.style.height = \"\";\n        sideWrapper.style.width = window.innerWidth + \"px\";\n    }\n    for (const topElem of $b4e14b6b8da86996$var$topElems)topElem.style.width = topElem.style.height = (landscape ? window.innerWidth : window.innerHeight) * 0.03 + \"px\";\n    for (const bottomElem of $b4e14b6b8da86996$var$bottomElems)bottomElem.style.width = bottomElem.style.height = (landscape ? window.innerWidth : window.innerHeight) * 0.035 + \"px\";\n    for (const elem of $b4e14b6b8da86996$var$allElems)elem.style.margin = (landscape ? window.innerWidth : window.innerHeight) * 0.02 + \"px\";\n    $b4e14b6b8da86996$var$shutter.style.width = $b4e14b6b8da86996$var$shutter.style.height = (landscape ? window.innerWidth : window.innerHeight) * 0.05 + \"px\";\n    const pastBorderSize = (landscape ? window.innerWidth : window.innerHeight) * 0.002 + \"px\";\n    $b4e14b6b8da86996$var$pastWrapper.style.borderRadius = pastBorderSize;\n    $b4e14b6b8da86996$var$pastWrapper.style.border = pastBorderSize + \" solid white\";\n    if (landscape) {\n        $b4e14b6b8da86996$var$preview.style.height = cssHeight;\n        $b4e14b6b8da86996$var$preview.style.width = \"\";\n        $b4e14b6b8da86996$var$root.style.flexDirection = \"row\";\n    } else {\n        $b4e14b6b8da86996$var$preview.style.height = \"\";\n        $b4e14b6b8da86996$var$preview.style.width = cssWidth;\n        $b4e14b6b8da86996$var$root.style.flexDirection = \"column\";\n    }\n    const constraints = {\n        width: maxRes.width,\n        height: maxRes.height,\n        deviceId: {\n            exact: maxRes.deviceId\n        }\n    };\n    const stream = await navigator.mediaDevices.getUserMedia({\n        video: constraints\n    });\n    const videoTrack = stream.getVideoTracks()[0];\n    const capabilities = videoTrack.getCapabilities();\n    $b4e14b6b8da86996$var$flashWrapper.style.display = capabilities.torch ? \"\" : \"none\";\n    $b4e14b6b8da86996$var$preview.srcObject = stream;\n    let newElems = [];\n    const clearNewElems = ()=>{\n        for (const elem of newElems)$b4e14b6b8da86996$var$previewDoc.removeChild(elem);\n        newElems.length = 0;\n    };\n    const onMetadata = ()=>{\n        const scale = landscape ? window.innerHeight / $b4e14b6b8da86996$var$preview.videoHeight : window.innerWidth / $b4e14b6b8da86996$var$preview.videoWidth;\n        const docPreview = async ()=>{\n            let quad;\n            const ts = performance.now();\n            if ($b4e14b6b8da86996$var$modal.style.display == \"none\") quad = await (0, $191e7775e3189472$export$c5fefc891e91de4b)(await (0, $aa7f0fbc084e0a0e$export$7a171f172be0782e)(await cap.grabFrame()), true);\n            clearNewElems();\n            if (docPreviewTimeout != -1) {\n                if (quad) newElems = [\n                    $b4e14b6b8da86996$var$previewDoc.appendChild($b4e14b6b8da86996$var$line(quad.a, quad.b, scale)),\n                    $b4e14b6b8da86996$var$previewDoc.appendChild($b4e14b6b8da86996$var$line(quad.b, quad.c, scale)),\n                    $b4e14b6b8da86996$var$previewDoc.appendChild($b4e14b6b8da86996$var$line(quad.c, quad.d, scale)),\n                    $b4e14b6b8da86996$var$previewDoc.appendChild($b4e14b6b8da86996$var$line(quad.d, quad.a, scale))\n                ];\n                docPreviewTimeout = setTimeout(docPreview, Math.max(250 - performance.now() + ts, 0));\n            }\n        };\n        docPreviewTimeout = setTimeout(docPreview, 0);\n    };\n    $b4e14b6b8da86996$var$preview.addEventListener(\"loadedmetadata\", onMetadata);\n    const cap = new ImageCapture(videoTrack);\n    let hd = Object.prototype.toString.call(cap) == \"[object ImageCapture]\";\n    $b4e14b6b8da86996$var$qualityWrapper.style.display = hd ? \"\" : \"none\";\n    $b4e14b6b8da86996$var$qualityImg.src = (0, (/*@__PURE__*/$parcel$interopDefault($009ec47ee18c0b40$exports)));\n    const onQualityClick = ()=>{\n        hd = !hd;\n        $b4e14b6b8da86996$var$qualityImg.src = hd ? (0, (/*@__PURE__*/$parcel$interopDefault($009ec47ee18c0b40$exports))) : (0, (/*@__PURE__*/$parcel$interopDefault($954630f75b1da243$exports)));\n    };\n    $b4e14b6b8da86996$var$quality.addEventListener(\"click\", onQualityClick);\n    let docPreviewTimeout = -1;\n    const shutterFlash = ()=>{\n        $b4e14b6b8da86996$var$preview.style.opacity = \"0\";\n        setTimeout(()=>$b4e14b6b8da86996$var$preview.style.opacity = \"\", 50);\n    };\n    const onShutterClick = async ()=>{\n        if ($b4e14b6b8da86996$var$shutter.style.opacity == \"\") {\n            $b4e14b6b8da86996$var$shutter.style.opacity = \"0.5\";\n            shutterFlash();\n            try {\n                const photo = hd ? await cap.takePhoto() : await cap.grabFrame();\n                await $b4e14b6b8da86996$var$processPhotos([\n                    photo\n                ]);\n            } catch (e) {}\n            $b4e14b6b8da86996$var$shutter.style.opacity = \"\";\n        }\n    };\n    $b4e14b6b8da86996$var$shutter.addEventListener(\"click\", onShutterClick);\n    let torch = false;\n    $b4e14b6b8da86996$var$flashImg.src = (0, (/*@__PURE__*/$parcel$interopDefault($bb74cf2efca2bea5$exports)));\n    const onFlashClick = async ()=>{\n        try {\n            torch = !torch;\n            await videoTrack.applyConstraints({\n                advanced: [\n                    {\n                        torch: torch\n                    }\n                ]\n            });\n            $b4e14b6b8da86996$var$flashImg.src = torch ? (0, (/*@__PURE__*/$parcel$interopDefault($5680d29e5f9eab67$exports))) : (0, (/*@__PURE__*/$parcel$interopDefault($bb74cf2efca2bea5$exports)));\n        } catch (e) {}\n    };\n    $b4e14b6b8da86996$var$flash.addEventListener(\"click\", onFlashClick);\n    return {\n        deviceId: maxRes.deviceId,\n        close () {\n            clearTimeout(docPreviewTimeout);\n            docPreviewTimeout = -1;\n            $b4e14b6b8da86996$var$shutter.removeEventListener(\"click\", onShutterClick);\n            $b4e14b6b8da86996$var$flash.removeEventListener(\"click\", onFlashClick);\n            $b4e14b6b8da86996$var$quality.removeEventListener(\"click\", onQualityClick);\n            $b4e14b6b8da86996$var$preview.removeEventListener(\"loadedmetadata\", onMetadata);\n            $b4e14b6b8da86996$var$preview.pause();\n            for (const track of stream.getTracks())track.stop();\n        }\n    };\n};\nconst $b4e14b6b8da86996$var$onLoad = async ()=>{\n    let stream = await $b4e14b6b8da86996$var$startStream(localStorage.getItem(\"defaultDevice\"));\n    const updateBold = ()=>{\n        for (const option of $b4e14b6b8da86996$var$select.options)option.style.fontWeight = \"\";\n        $b4e14b6b8da86996$var$select.selectedOptions[0].style.fontWeight = \"bold\";\n    };\n    for (const device of (await navigator.mediaDevices.enumerateDevices()))if (device.kind == \"videoinput\") {\n        const option = document.createElement(\"option\");\n        option.value = device.deviceId;\n        option.label = device.label;\n        $b4e14b6b8da86996$var$select.appendChild(option);\n    }\n    $b4e14b6b8da86996$var$select.value = stream.deviceId;\n    updateBold();\n    const update = async ()=>{\n        updateBold();\n        stream.close();\n        $b4e14b6b8da86996$var$select.disabled = true;\n        localStorage.setItem(\"defaultDevice\", $b4e14b6b8da86996$var$select.value);\n        stream = await $b4e14b6b8da86996$var$startStream($b4e14b6b8da86996$var$select.value);\n        $b4e14b6b8da86996$var$select.disabled = false;\n    };\n    $b4e14b6b8da86996$var$select.onchange = update;\n    $b4e14b6b8da86996$var$onResize(update);\n    $b4e14b6b8da86996$var$upload.onchange = async ()=>{\n        $b4e14b6b8da86996$var$shutter.style.opacity = \"0.5\";\n        await $b4e14b6b8da86996$var$processPhotos([\n            ...$b4e14b6b8da86996$var$upload.files\n        ]);\n        $b4e14b6b8da86996$var$shutter.style.opacity = \"\";\n    };\n    $b4e14b6b8da86996$var$done.onclick = async ()=>{\n        if ($b4e14b6b8da86996$var$pages.length) {\n            $b4e14b6b8da86996$var$doneWrapper.style.opacity = \"0.5\";\n            while($b4e14b6b8da86996$var$pastWrapper.lastChild != $b4e14b6b8da86996$var$past)$b4e14b6b8da86996$var$pastWrapper.removeChild($b4e14b6b8da86996$var$pastWrapper.lastChild);\n            (0, $aa7f0fbc084e0a0e$export$24422be91ad4011f)(new Blob([\n                await (0, $98ce8732f7dffb75$export$99fdcdff3bb1ad24)(await Promise.all($b4e14b6b8da86996$var$pages.map(({ data: data, quad: quad })=>(0, $191e7775e3189472$export$ab8ba24d4c0c8986)(data, quad, 1224, true))))\n            ]), \"out.pdf\");\n            $b4e14b6b8da86996$var$pages.length = 0;\n        }\n    };\n    $b4e14b6b8da86996$var$past.onclick = async ()=>{\n        if ($b4e14b6b8da86996$var$pages.length) {\n            const currPages = $b4e14b6b8da86996$var$pages.slice();\n            $b4e14b6b8da86996$var$pages.length = 0;\n            if (!await $b4e14b6b8da86996$var$processPhotos(currPages)) {\n                $b4e14b6b8da86996$var$pages.push(...currPages);\n                const { img: img } = currPages[currPages.length - 1];\n                if (img.width > img.height) {\n                    img.style.height = $b4e14b6b8da86996$var$pastWrapper.style.height;\n                    img.style.width = \"\";\n                } else {\n                    img.style.height = \"\";\n                    img.style.width = $b4e14b6b8da86996$var$pastWrapper.style.width;\n                }\n                while($b4e14b6b8da86996$var$pastWrapper.lastChild != $b4e14b6b8da86996$var$past)$b4e14b6b8da86996$var$pastWrapper.removeChild($b4e14b6b8da86996$var$pastWrapper.lastChild);\n                $b4e14b6b8da86996$var$pastWrapper.appendChild(img);\n            }\n        }\n    };\n};\n$b4e14b6b8da86996$var$onLoad();\nvar $6d2b58ea9d1b18f4$exports = {};\n\n$6d2b58ea9d1b18f4$exports = new URL(\"workers/\" + (parcelRequire(\"27Lyk\")).resolve(\"drXuR\"), import.meta.url).toString();\n\n\nnavigator.serviceWorker.register($6d2b58ea9d1b18f4$exports);\n\n\n//# sourceMappingURL=index.ec5a4b7d.js.map\n","\"use strict\";\n\nvar mapping = {};\nfunction register(pairs) {\n  var keys = Object.keys(pairs);\n  for (var i = 0; i < keys.length; i++) {\n    mapping[keys[i]] = pairs[keys[i]];\n  }\n}\nfunction resolve(id) {\n  var resolved = mapping[id];\n  if (resolved == null) {\n    throw new Error('Could not resolve bundle with id ' + id);\n  }\n  return resolved;\n}\nmodule.exports.register = register;\nmodule.exports.resolve = resolve;","require('./helpers/bundle-manifest').register(JSON.parse(\"{\\\"1LzKV\\\":\\\"index.ec5a4b7d.js\\\",\\\"a2Cve\\\":\\\"process.8010e3f6.js\\\",\\\"bj76Q\\\":\\\"flash.7ae5cfb8.svg\\\",\\\"e0Dy9\\\":\\\"flash-off.f95884b2.svg\\\",\\\"lX2gi\\\":\\\"hd.0cfe4ff9.svg\\\",\\\"gltHY\\\":\\\"sd.25c2f123.svg\\\",\\\"drXuR\\\":\\\"service.js\\\"}\"));","import { findDocument, extractDocument, Point, Quad } from './process';\nimport { toPDF } from './pdf';\nimport { toImage, getData, download } from './io';\nimport { ProspectivePage, getFile, setFile } from './db';\nimport flashURL from 'url:./flash.svg';\nimport flashOffURL from 'url:./flash-off.svg';\nimport hdURL from 'url:./hd.svg';\nimport sdURL from 'url:./sd.svg';\nimport 'image-capture';\n\nconst root = document.getElementById('root') as HTMLDivElement;\nconst modal = document.getElementById('modal') as HTMLDivElement;\nconst captures = document.getElementById('captures') as HTMLDivElement;\nconst preview = document.getElementById('preview') as HTMLVideoElement;\nconst previewCrop = document.getElementById('preview-crop') as HTMLDivElement;\nconst previewDoc = document.getElementById('preview-doc') as HTMLDivElement;\nconst bottomWrapper = document.getElementById('bottom-wrapper') as HTMLDivElement;\nconst topWrapper = document.getElementById('top-wrapper') as HTMLDivElement;\nconst selectWrapper = document.getElementById('camera-select-wrapper') as HTMLDivElement;\nconst select = document.getElementById('camera-select') as HTMLSelectElement;\nconst qualityWrapper = document.getElementById('quality-wrapper') as HTMLDivElement;\nconst quality = document.getElementById('quality') as HTMLButtonElement;\nconst qualityImg = document.getElementById('quality-img') as HTMLImageElement;\nconst githubWrapper = document.getElementById('github-wrapper') as HTMLDivElement;\nconst flashWrapper = document.getElementById('flash-wrapper') as HTMLDivElement;\nconst flash = document.getElementById('flash') as HTMLButtonElement;\nconst flashImg = document.getElementById('flash-img') as HTMLImageElement;\nconst pastWrapper = document.getElementById('past-wrapper') as HTMLDivElement;\nconst past = document.getElementById('past') as HTMLDivElement;\nconst uploadWrapper = document.getElementById('upload-wrapper') as HTMLDivElement;\nconst upload = document.getElementById('upload') as HTMLInputElement;\nconst shutter = document.getElementById('shutter') as HTMLImageElement;\nconst doneWrapper = document.getElementById('done-wrapper') as HTMLDivElement;\nconst done = document.getElementById('done') as HTMLButtonElement;\nconst modalBottomWrapper = document.getElementById('modal-bottom-wrapper') as HTMLDivElement;\nconst modalCancelWrapper = document.getElementById('modal-cancel-wrapper') as HTMLDivElement;\nconst modalCancel = document.getElementById('modal-cancel') as HTMLButtonElement;\nconst modalDoneWrapper = document.getElementById('modal-done-wrapper') as HTMLDivElement;\nconst modalDone = document.getElementById('modal-done') as HTMLButtonElement;\ntype Dimensions = {\n  width: number;\n  height: number;\n};\n\ntype MaxRes = Dimensions & {\n  deviceId: string;\n};\n\nlet defaultMaxRes: Promise<MaxRes>;\nlet maxRes: Record<string, Promise<MaxRes> | undefined> = {};\n\ntype Page = ProspectivePage & {\n  img: HTMLImageElement | HTMLCanvasElement;\n};\n\nconst pages: Page[] = [];\n\nconst log = (text: string) => {\n  const el = document.createElement('div');\n  el.innerText = text;\n  root.appendChild(el);\n}\n\nconst resizeListeners: (() => void)[] = [];\n\nconst onResize = (listener: () => void) => {\n  resizeListeners.push(listener);\n  return () => {\n    resizeListeners.splice(resizeListeners.indexOf(listener), 1);\n  };\n};\n\nconst callResizeListeners = () => {\n  for (const listener of resizeListeners) {\n    listener();\n  }\n};\n\nlet rst = -1;\nwindow.addEventListener('resize', () => {\n  clearTimeout(rst);\n  rst = setTimeout(callResizeListeners, 250) as unknown as number;\n}, { passive: true });\n\nconst getMaxRes = (device?: string) => {\n  const constraints: MediaTrackConstraints = {\n    width: 100000,\n    height: 100000,\n    facingMode: 'environment'\n  };\n  if (device) {\n    if (maxRes[device]) return maxRes[device]!;\n    constraints.deviceId = { exact: device };\n  } else if (defaultMaxRes) {\n    return defaultMaxRes;\n  }\n  const prom = navigator.mediaDevices.getUserMedia({\n    video: constraints \n  }).then(media => {\n    const settings = media.getVideoTracks()[0].getSettings();\n    for (const track of media.getTracks()) {\n      track.stop();\n    }\n    const width = Math.max(settings.width!, settings.height!);\n    const height = Math.min(settings.width!, settings.height!);\n    return { width, height, deviceId: settings.deviceId! };\n  });\n  if (device) maxRes[device] = prom;\n  else defaultMaxRes = prom.then(val => {\n    maxRes[val.deviceId] = prom;\n    return val;\n  });\n  return prom;\n}\n\nconst point = (a: Point, scale: number) => {\n  const elem = document.createElement('div');\n  const mwh = Math.min(window.innerWidth, window.innerHeight);\n  elem.style.width = mwh * 0.03 + 'px';\n  elem.style.height = mwh * 0.03 + 'px';\n  elem.style.borderRadius = mwh * 0.015 + 'px';\n  elem.style.backgroundColor = 'black';\n  elem.style.position = 'absolute';\n  adjustPoint(elem, a, scale);\n  return elem;\n};\n\nconst adjustPoint = (elem: HTMLDivElement, a: Point, scale: number) => {\n  const mwh = Math.min(window.innerWidth, window.innerHeight);\n  elem.style.top = a.y * scale - mwh * 0.015 + 'px';\n  elem.style.left = a.x * scale - mwh * 0.015 + 'px';\n};\n\nconst line = (a: Point, b: Point, scale: number) => {\n  const elem = document.createElement('div');\n  elem.style.height = '4px';\n  elem.style.backgroundColor = 'red';\n  elem.style.position = 'absolute';\n  elem.style.transformOrigin = 'center left';\n  adjustLine(elem, a, b, scale);\n  return elem;\n};\n\nconst adjustLine = (elem: HTMLDivElement, a: Point, b: Point, scale: number) => {\n  elem.style.width = Math.hypot(a.x - b.x, a.y - b.y) * scale + 'px';\n  elem.style.top = a.y * scale + 'px';\n  elem.style.left = a.x * scale + 'px';\n  elem.style.transform = `rotate(${Math.atan2(b.y - a.y, b.x - a.x)}rad)`;\n}\n\nconst preprocessPhoto = async (src: Blob | ImageBitmap) => {\n  let img: HTMLImageElement | HTMLCanvasElement, data: ImageData;\n  if (src instanceof Blob) {\n    const image = await toImage(src);\n    img = image;\n    data = await getData(image);\n  } else {\n    const cnv = document.createElement('canvas');\n    cnv.width = src.width;\n    cnv.height = src.height;\n    cnv.getContext('2d')!.drawImage(src, 0, 0);\n    img = cnv;\n    data = await getData(src, true);\n  }\n  const quad = await findDocument(data) || {\n    a: { x: 0, y: data.height },\n    b: { x: 0, y: 0 },\n    c: { x: data.width, y: 0 },\n    d: { x: data.width, y: data.height }\n  };\n  const clampPoint = (a: Point) => {\n    if (a.x < 0) a.x = 0;\n    else if (a.x > data.width) a.x = data.width;\n    if (a.y < 0) a.y = 0;\n    else if (a.y > data.height) a.y = data.height;\n  };\n  clampPoint(quad.a);\n  clampPoint(quad.b);\n  clampPoint(quad.c);\n  clampPoint(quad.d);\n  return { img, data, quad };\n};\n\nconst processPhotos = async (srcs: (Blob | ImageBitmap | Page)[]) => {\n  const results = srcs.map(src => src instanceof Blob || src instanceof ImageBitmap ? preprocessPhoto(src) : src);\n  const cbs: ((check: boolean) => void)[] = [];\n  let firstDimensions = { width: 0, height: 0 };\n  let landscape = false;\n  for (const result of results) {\n    const isFirst = result == results[0];\n    const isLast = result == results[results.length - 1];\n    const { img, data, quad } = await result;\n    const imgCrop = document.createElement('div');\n    imgCrop.style.display = 'flex';\n    imgCrop.style.justifyContent = 'center';\n    imgCrop.style.alignItems = 'center';\n    imgCrop.style.overflow = 'hidden';\n    imgCrop.style.scrollSnapAlign = 'center';\n    const imgDoc = document.createElement('div');\n    imgDoc.style.position = 'relative';\n    imgDoc.appendChild(img);\n    imgCrop.appendChild(imgDoc);\n    modal.style.display = 'flex';\n    const aspectRatio = Math.max(data.width, data.height) / Math.min(data.width, data.height);\n    let scale = 0, docX = 0, docY = 0, latestDims = false;\n    let prevElems: HTMLDivElement[] = [];\n    const getLatestDims = () => {\n      if (!latestDims) {\n        const { left, top } = imgDoc.getBoundingClientRect();\n        docX = left;\n        docY = top;\n        latestDims = true; \n      }\n    }\n    const makePoint = (src: Point, onUpdate: () => void) => {\n      const pt = point(src, scale);\n      let active = false;\n      const onDown = (evt: MouseEvent | TouchEvent, x: number, y: number) => {\n        if (pt.parentElement == imgDoc) {\n          if (evt.target == pt || (evt.target == img && Math.hypot(x - src.x * scale, y - src.y * scale) < Math.min(window.innerWidth, window.innerHeight) * 0.2)) {\n            evt.stopImmediatePropagation();\n            active = true;\n            onMove(x, y);\n          }\n        } else {\n          imgDoc.removeEventListener('mousedown', onMouseDown);\n          imgDoc.removeEventListener('touchstart', onTouchStart);\n          imgDoc.removeEventListener('mousemove', onMouseMove);\n          imgDoc.removeEventListener('touchmove', onTouchMove);\n          imgDoc.removeEventListener('mouseup', onUp);\n          imgDoc.removeEventListener('touchend', onUp);\n        }\n      };\n      const onMove = (x: number, y: number) => {\n        src.x = x / scale;\n        src.y = y / scale;\n        adjustPoint(pt, src, scale);\n        onUpdate();\n      };\n      const onUp = () => {\n        active = false;\n      };\n      const onMouseDown = (e: MouseEvent) => {\n        getLatestDims();\n        onDown(e, e.pageX - docX, e.pageY - docY);\n      };\n      imgDoc.addEventListener('mousedown', onMouseDown);\n      const onTouchStart = (e: TouchEvent) => {\n        const touch = e.targetTouches[0];\n        getLatestDims();\n        onDown(e, touch.pageX - docX, touch.pageY - docY);\n      }\n      imgDoc.addEventListener('touchstart', onTouchStart);\n      const onMouseMove = (e: MouseEvent) => {\n        if (active) {\n          e.preventDefault();\n          onMove(e.pageX - docX, e.pageY - docY);\n        }\n      };\n      imgDoc.addEventListener('mousemove', onMouseMove);\n      const onTouchMove = (e: TouchEvent) => {\n        if (active) {\n          const touch = e.targetTouches[0];\n          e.preventDefault();\n          onMove(touch.pageX - docX, touch.pageY - docY);\n        }\n      }\n      imgDoc.addEventListener('touchmove', onTouchMove);\n      imgDoc.addEventListener('mouseup', onUp);\n      imgDoc.addEventListener('touchend', onUp);\n      return pt;\n    }\n    const paintLines = () => {\n      for (const elem of prevElems) {\n        imgDoc.removeChild(elem);\n      }\n      const ab = line(quad.a, quad.b, scale);\n      const bc = line(quad.b, quad.c, scale);\n      const cd = line(quad.c, quad.d, scale);\n      const da = line(quad.d, quad.a, scale);\n      prevElems = [\n        imgDoc.appendChild(ab),\n        imgDoc.appendChild(bc),\n        imgDoc.appendChild(cd),\n        imgDoc.appendChild(da),\n        imgDoc.appendChild(makePoint(quad.a, () => {\n          adjustLine(da, quad.d, quad.a, scale);\n          adjustLine(ab, quad.a, quad.b, scale);\n        })),\n        imgDoc.appendChild(makePoint(quad.b, () => {\n          adjustLine(ab, quad.a, quad.b, scale);\n          adjustLine(bc, quad.b, quad.c, scale);\n        })),\n        imgDoc.appendChild(makePoint(quad.c, () => {\n          adjustLine(bc, quad.b, quad.c, scale);\n          adjustLine(cd, quad.c, quad.d, scale);\n        })),\n        imgDoc.appendChild(makePoint(quad.d, () => {\n          adjustLine(cd, quad.c, quad.d, scale);\n          adjustLine(da, quad.d, quad.a, scale);\n        })),\n      ];\n    };\n    const updateImageDimensions = () => {\n      const { width, height } = isFirst ? calcDimensions(aspectRatio, 0.925) : firstDimensions;\n      if (isFirst) {\n        landscape = isLandscape(aspectRatio);\n        firstDimensions = { width, height };\n        modalCancelWrapper.style.width = modalCancelWrapper.style.height = modalDoneWrapper.style.width = modalDoneWrapper.style.height = (landscape ? window.innerWidth : window.innerHeight) * 0.035 + 'px';\n        modalCancelWrapper.style.margin = modalDoneWrapper.style.margin = (landscape ? window.innerWidth : window.innerHeight) * 0.02 + 'px';\n        captures.style.width = modal.style.width = window.innerWidth + 'px';\n        captures.style.height = modal.style.height = window.innerHeight + 'px';\n        modal.style.flexDirection = landscape ? 'row' : 'column';\n        captures.style.flexDirection = landscape ? 'column' : 'row';\n        if (landscape) {\n          modalBottomWrapper.style.flexDirection = 'column';\n          modalBottomWrapper.style.height = window.innerHeight + 'px';\n          modalBottomWrapper.style.width = ''; \n        } else {\n          modalBottomWrapper.style.flexDirection = 'row';\n          modalBottomWrapper.style.height = '';\n          modalBottomWrapper.style.width = window.innerWidth + 'px';   \n        }\n      }\n      const cssWidth = width + 'px';\n      const cssHeight = height + 'px';\n    \n      if (landscape) {\n        img.style.width = '';\n        img.style.height = cssHeight;\n        scale = window.innerHeight / data.height;\n      } else {\n        img.style.width = cssWidth;\n        img.style.height = '';\n        scale = window.innerWidth / data.width;\n      }\n      imgCrop.style.width = imgCrop.style.minWidth = cssWidth;\n      imgCrop.style.height = imgCrop.style.minHeight = cssHeight;\n      latestDims = false;\n      paintLines();\n    };\n    updateImageDimensions();\n    captures.appendChild(imgCrop);\n    const offResize = onResize(updateImageDimensions);\n    cbs.push(check => {\n      if (check) {\n        pages.push({ data, quad, img });\n        doneWrapper.style.opacity = '';\n        if (isLast) {\n          if (img.width > img.height) {\n            img.style.height = pastWrapper.style.height;\n            img.style.width = '';\n          } else {\n            img.style.height = '';\n            img.style.width = pastWrapper.style.width;\n          }\n          while (pastWrapper.lastChild != past) {\n            pastWrapper.removeChild(pastWrapper.lastChild!);\n          }\n          pastWrapper.appendChild(img);\n        }\n      }\n      offResize();\n      captures.removeChild(imgCrop);\n    })\n  }\n\n  return new Promise(resolve => {\n    const onDone = () => finish(true);\n    const onCancel = () => finish(false);\n    modalCancel.addEventListener('click', onCancel);\n    modalDone.addEventListener('click', onDone);\n    const finish = (check: boolean) => {\n      modalDone.removeEventListener('click', onDone);\n      modalCancel.removeEventListener('click', onCancel);\n      modal.style.display = 'none';\n      for (const cb of cbs) {\n        cb(check);\n      }\n      resolve(check);\n    };\n  });\n}\n\nconst isLandscape = (aspectRatio: number) => window.innerWidth > (window.innerHeight * aspectRatio);\n\nconst calcDimensions = (aspectRatio: number, maxRatio: number) => {\n  const landscape = isLandscape(aspectRatio);\n  const height = landscape ? window.innerHeight : Math.floor(Math.min(window.innerWidth * aspectRatio, window.innerHeight * maxRatio));\n  const width = landscape ? Math.floor(Math.min(window.innerHeight * aspectRatio, window.innerWidth * maxRatio)) : window.innerWidth;\n  return { width, height };\n}\n\nconst sideWrappers = [topWrapper, bottomWrapper];\nconst topElems = [flashWrapper, qualityWrapper, githubWrapper, selectWrapper, pastWrapper];\nconst bottomElems = [doneWrapper, uploadWrapper];\nconst allElems = topElems.concat(bottomElems, shutter);\n\nconst startStream = async (device?: string) => {\n  const maxRes = await getMaxRes(device);\n  let aspectRatio = maxRes.width / maxRes.height;\n  const landscape = isLandscape(aspectRatio);\n  const { width, height } = calcDimensions(aspectRatio, 0.84);\n  const cssHeight = height + 'px';\n  const cssWidth = width + 'px';\n  previewCrop.style.width = previewCrop.style.minWidth = cssWidth;\n  previewCrop.style.height = previewCrop.style.minHeight = cssHeight;\n  root.style.width = window.innerWidth + 'px';\n  root.style.height = window.innerHeight + 'px';\n  for (const sideWrapper of sideWrappers) {\n    if (landscape) {\n      sideWrapper.style.flexDirection = 'column';\n      sideWrapper.style.height = window.innerHeight + 'px';\n      sideWrapper.style.width = '';\n    } else {\n      sideWrapper.style.flexDirection = 'row';\n      sideWrapper.style.height = '';\n      sideWrapper.style.width = window.innerWidth + 'px';   \n    }\n  }\n  for (const topElem of topElems) {\n    topElem.style.width = topElem.style.height = (landscape ? window.innerWidth : window.innerHeight) * 0.03 + 'px';\n  }\n  for (const bottomElem of bottomElems) {\n    bottomElem.style.width = bottomElem.style.height = (landscape ? window.innerWidth : window.innerHeight) * 0.035 + 'px';\n  }\n  for (const elem of allElems) {\n    elem.style.margin = (landscape ? window.innerWidth : window.innerHeight) * 0.02 + 'px';\n  }\n  shutter.style.width = shutter.style.height = (landscape ? window.innerWidth : window.innerHeight) * 0.05 + 'px';\n  const pastBorderSize = (landscape ? window.innerWidth : window.innerHeight) * 0.002 + 'px';\n  pastWrapper.style.borderRadius = pastBorderSize;\n  pastWrapper.style.border = pastBorderSize + ' solid white';\n  if (landscape) {\n    preview.style.height = cssHeight;\n    preview.style.width = '';\n    root.style.flexDirection = 'row';\n  } else {\n    preview.style.height = '';\n    preview.style.width = cssWidth;\n    root.style.flexDirection = 'column';\n  }\n  const constraints: MediaTrackConstraints = {\n    width: maxRes.width, \n    height: maxRes.height,\n    deviceId: { exact: maxRes.deviceId }\n  };\n  const stream = await navigator.mediaDevices.getUserMedia({\n    video: constraints\n  });\n  const videoTrack = stream.getVideoTracks()[0];\n  const capabilities = videoTrack.getCapabilities();\n  flashWrapper.style.display = capabilities.torch ? '' : 'none';\n  preview.srcObject = stream;\n  let newElems: Node[] = [];\n  const clearNewElems = () => {\n    for (const elem of newElems) {\n      previewDoc.removeChild(elem);\n    };\n    newElems.length = 0;\n  }\n  const onMetadata = () => {\n    const scale = landscape ? window.innerHeight / preview.videoHeight : window.innerWidth / preview.videoWidth;\n    const docPreview = async () => {\n      let quad: Quad | undefined;\n      const ts = performance.now();\n      if (modal.style.display == 'none') {\n        quad = await findDocument(await getData(await cap.grabFrame()), true);\n      }\n      clearNewElems();\n      if (docPreviewTimeout != -1) {\n        if (quad) {\n          newElems = [\n            previewDoc.appendChild(line(quad.a, quad.b, scale)),\n            previewDoc.appendChild(line(quad.b, quad.c, scale)),\n            previewDoc.appendChild(line(quad.c, quad.d, scale)),\n            previewDoc.appendChild(line(quad.d, quad.a, scale))\n          ];\n        }\n        docPreviewTimeout = setTimeout(docPreview, Math.max(250 - performance.now() + ts, 0)) as unknown as number;\n      }\n    };\n    docPreviewTimeout = setTimeout(docPreview, 0) as unknown as number;\n  };\n  preview.addEventListener('loadedmetadata', onMetadata);\n  const cap = new ImageCapture(videoTrack);\n  let hd = Object.prototype.toString.call(cap) == '[object ImageCapture]';\n  qualityWrapper.style.display = hd ? '' : 'none';\n  qualityImg.src = hdURL;\n  const onQualityClick = () => {\n    hd = !hd;\n    qualityImg.src = hd ? hdURL : sdURL;\n  };\n  quality.addEventListener('click', onQualityClick);\n  let docPreviewTimeout = -1;\n  const shutterFlash = () => {\n    preview.style.opacity = '0';\n    setTimeout(() => preview.style.opacity = '', 50);\n  };\n  const onShutterClick = async () => {\n    if (shutter.style.opacity == '') {\n      shutter.style.opacity = '0.5';\n      shutterFlash();\n      try {\n        const photo = hd ? await cap.takePhoto() : await cap.grabFrame();\n        await processPhotos([photo]);\n      } catch (e) {}\n      shutter.style.opacity = '';\n    }\n  };\n  shutter.addEventListener('click', onShutterClick);\n  let torch = false;\n  flashImg.src = flashOffURL;\n  const onFlashClick = async () => {\n    try {\n      torch = !torch;\n      await videoTrack.applyConstraints({\n        advanced: [{ torch }]\n      });\n      flashImg.src = torch ? flashURL : flashOffURL;\n    } catch (e) {}\n  };\n  flash.addEventListener('click', onFlashClick);\n  return {\n    deviceId: maxRes.deviceId,\n    close() {\n      clearTimeout(docPreviewTimeout);\n      docPreviewTimeout = -1;\n      shutter.removeEventListener('click', onShutterClick);\n      flash.removeEventListener('click', onFlashClick);\n      quality.removeEventListener('click', onQualityClick);\n      preview.removeEventListener('loadedmetadata', onMetadata);\n      preview.pause();\n      for (const track of stream.getTracks()) {\n        track.stop();\n      }\n    }\n  }\n}\n\n\nconst onLoad = async () => {\n  let stream = await startStream(localStorage.getItem('defaultDevice')!);\n  const updateBold = () => {\n    for (const option of select.options) {\n      option.style.fontWeight = '';\n    }\n    select.selectedOptions[0].style.fontWeight = 'bold';\n  }\n  for (const device of await navigator.mediaDevices.enumerateDevices()) {\n    if (device.kind == 'videoinput') {\n      const option = document.createElement('option');\n      option.value = device.deviceId;\n      option.label = device.label;\n      select.appendChild(option);\n    }\n  }\n  select.value = stream.deviceId;\n  updateBold();\n  const update = async () => {\n    updateBold();\n    stream.close();\n    select.disabled = true;\n    localStorage.setItem('defaultDevice', select.value);\n    stream = await startStream(select.value);\n    select.disabled = false;\n  };\n  select.onchange = update;\n  onResize(update);\n  upload.onchange = async () => {\n    shutter.style.opacity = '0.5';\n    await processPhotos([...upload.files!]);\n    shutter.style.opacity = '';\n  };\n  done.onclick = async () => {\n    if (pages.length) {\n      doneWrapper.style.opacity = '0.5';\n      while (pastWrapper.lastChild != past) {\n        pastWrapper.removeChild(pastWrapper.lastChild!);\n      }\n      download(new Blob([await toPDF(await Promise.all(pages.map(({ data, quad }) => extractDocument(data, quad, 1224, true))))]), 'out.pdf')\n      pages.length = 0;\n    }\n  }\n  past.onclick = async () => {\n    if (pages.length) {\n      const currPages = pages.slice();\n      pages.length = 0;\n      if (!(await processPhotos(currPages))) {\n        pages.push(...currPages);\n        const { img } = currPages[currPages.length - 1];\n        if (img.width > img.height) {\n          img.style.height = pastWrapper.style.height;\n          img.style.width = '';\n        } else {\n          img.style.height = '';\n          img.style.width = pastWrapper.style.width;\n        }\n        while (pastWrapper.lastChild != past) {\n          pastWrapper.removeChild(pastWrapper.lastChild!);\n        }\n        pastWrapper.appendChild(img);\n      }\n    }\n  }\n}\n\nonLoad();\n\nif (process.env.NODE_ENV == 'production') {\n  navigator.serviceWorker.register(new URL('./workers/service.ts', import.meta.url), { type: 'module' });\n}\n","import type { Message, Messages, Quad, Point } from './workers/ipc';\n\nconst newWorker = () => new Worker(new URL('./workers/process.ts', import.meta.url), { type: 'module' });\n\nconst processWorkers: Worker[] = [];\n\nif (navigator.hardwareConcurrency) {\n  for (let i = 1; i < navigator.hardwareConcurrency; ++i) {\n    processWorkers.push(newWorker());\n  }\n}\n\nconst getWorker = () => processWorkers.pop() || newWorker();\nconst returnWorker = (worker: Worker) => processWorkers.push(worker);\n\nlet messageID = 0;\n\nconst message = async <T extends Message>(msg: T, transfer?: Transferable[]) => {\n  return new Promise<Messages[T['type']][1]>((resolve, reject) => {\n    const worker = getWorker();\n    let id = messageID++;\n    // const ts = performance.now();\n    const onMessage = (evt: MessageEvent) => {\n      const { id: mid, error, result } = evt.data;\n      if (mid == id) {\n        if (error) {\n          let err = new Error(error.message);\n          err.stack = error.stack;\n          err.name = error.name;\n          reject(err);\n        } else {\n          resolve(result);\n        }\n        // console.log('Processed', msg, 'in', (performance.now() - ts) + 'ms', { result, error });\n        returnWorker(worker);\n        worker.removeEventListener('message', onMessage);\n      }\n    };\n    worker.addEventListener('message', onMessage);\n    worker.postMessage({ id, msg }, transfer || []);\n  })\n}\n\nexport function findDocument(data: ImageData, transfer?: boolean) {\n  return message({\n    type: 'find-document',\n    data\n  }, transfer ? [data.data.buffer] : []);\n}\n\nexport function extractDocument(data: ImageData, region: Quad, targetWidth: number, transfer?: boolean) {\n  return message({\n    type: 'extract-document',\n    data,\n    region,\n    targetWidth\n  }, transfer ? [data.data.buffer] : []);\n}\n\nexport function bitmapToData(bitmap: ImageBitmap, transfer?: boolean) {\n  return message({\n    type: 'get-data',\n    bitmap\n  }, transfer ? [bitmap] : []);\n}\n\nexport { Quad, Point }","let workerURL = require('./helpers/get-worker-url');\nlet url = new __parcel__URL__(require('./helpers/bundle-manifest').resolve(\"a2Cve\"));\nmodule.exports = workerURL(url.toString(), url.origin, true);","\"use strict\";\n\nmodule.exports = function (workerUrl, origin, isESM) {\n  if (origin === self.location.origin) {\n    // If the worker bundle's url is on the same origin as the document,\n    // use the worker bundle's own url.\n    return workerUrl;\n  } else {\n    // Otherwise, create a blob URL which loads the worker bundle with `importScripts`.\n    var source = isESM ? 'import ' + JSON.stringify(workerUrl) + ';' : 'importScripts(' + JSON.stringify(workerUrl) + ');';\n    return URL.createObjectURL(new Blob([source], {\n      type: 'application/javascript'\n    }));\n  }\n};","const readFile = Blob.prototype.arrayBuffer || function(this: Blob) {\n  return new Promise((resolve, reject) => {\n    const fr = new FileReader();\n    fr.onload = () => {\n      resolve(fr.result as ArrayBuffer);\n    };\n    fr.onerror = () => {\n      reject(fr.error);\n    };\n    fr.readAsArrayBuffer(this);\n  })\n}\n\nexport const toPDF = async (images: ImageData[]) => {\n  const pdfChunks: (string | ArrayLike<number>)[] = [];\n  let index = 0;\n  const offsets: number[] = [];\n  const write = (chunk: string | ArrayLike<number>) => {\n    pdfChunks.push(chunk);\n    index += chunk.length;\n  }\n  const token = (chunk: string | ArrayLike<number>) => {\n    write(' ');\n    write(chunk);\n  }\n  const concat = (chunks: (string | ArrayLike<number>)[]) => {\n    let len = 0;\n    for (const chunk of chunks) len += chunk.length;\n    const buf = new Uint8Array(len);\n    len = 0;\n    for (const chunk of chunks) {\n      if (typeof chunk == 'string') {\n        for (let i = 0; i < chunk.length; ++i) buf[i + len] = chunk.charCodeAt(i);\n      } else {\n        buf.set(chunk, len);\n      }\n      len += chunk.length;\n    }\n    return buf;\n  }\n  // Convenience functions\n  const comment = (content: string) => {\n    write(\"%\" + content + '\\n');\n  }\n  const number = (value: number) => {\n    // Note: this doesnt work for very small and very large numbers\n    token(value.toString());\n  }\n  const ascii = (value: string) => {\n    token('(' + value.replace(/[\\n\\r\\t\\f\\b\\(\\)\\\\]/g, c => '\\\\00' + c.charCodeAt(0).toString(8)) + ')');\n  }\n  const bin = (value: string | ArrayLike<number>) => {\n    let data = '<';\n    if (typeof value == 'string') {\n      for (let i = 0; i < value.length; ++i) {\n        data += value.charCodeAt(i).toString(16);\n      }\n    } else {\n      for (let i = 0; i < value.length; ++i) {\n        data += value[i].toString(16);\n      }\n    }\n    token(data + '>');\n  };\n  const name = (value: string) => {\n    // Note: only supports ASCII names\n    token('/' + value);\n  };\n  const array = (fn: () => void) => {\n    token('[');\n    fn();\n    token(']');\n  };\n  type Dict = Record<string, () => void>;\n  const dict = (values: Dict) => {\n    token('<<');\n    for (const key in values) {\n      name(key);\n      values[key]();\n    }\n    token('>>');\n  };\n  const stream = (desc: Dict, content: ArrayLike<number>) => {\n    if (process.env.NODE_ENV != 'production') {\n      if (!desc['Length']) throw new TypeError('need stream length');\n    }\n    dict(desc);\n    token('stream\\n');\n    write(content);\n    write('endstream');\n  };\n  const object = (fn: () => void) => {\n    write(' ');\n    write(offsets.push(index) + ' 0 obj');\n    fn();\n    token('endobj');\n    return offsets.length;\n  };\n  const reference = (id: number) => {\n    token(id + ' 0 R');\n  }\n  const nullObject = () => {\n    token('null');\n  };\n\n  // v1.4 for compatibility\n  comment('PDF-1.4');\n    // 4 byte binary comment, as suggested by spec\n  comment('\\x90\\x85\\xfa\\xe3');\n  const pages = await Promise.all(images.map(async img => {\n    const canvas = document.createElement('canvas');\n    canvas.width = img.width;\n    canvas.height = img.height;\n    canvas.getContext('2d')!.putImageData(img, 0, 0);\n    const jpeg = await new Promise(resolve => canvas.toBlob(resolve, 'image/jpeg'));\n    const jpegData = new Uint8Array(await readFile.call(jpeg));\n    const image = object(() => {\n      stream({\n        Type() {\n          name('XObject');\n        },\n        Subtype() {\n          name('Image');\n        },\n        Width() {\n          number(img.width);\n        },\n        Height() {\n          number(img.height);\n        },\n        ColorSpace() {\n          name('DeviceRGB');\n        },\n        BitsPerComponent() {\n          number(8);\n        },\n        Filter() {\n          name('DCTDecode');\n        },\n        Length() {\n          number(jpegData.length);\n        }\n      }, jpegData);\n    });\n    // US Letter width\n    const height = 792;\n    const width = height * img.width / img.height;\n    const contents = object(() => {\n      const result = `${width} 0 0 ${height} 0 0 cm /I Do`;\n      stream({\n        Length() {\n          number(result.length);\n        }\n      }, concat([\n        result\n      ]));\n    });\n    const page = object(() => {\n      dict({\n        Type() {\n          name('Page')\n        },\n        Parent() {\n          reference(offsets.length + 1);\n        },\n        Resources() {\n          dict({\n            XObject() {\n              dict({\n                I() {\n                  reference(image);\n                }\n              });\n            }\n          });\n        },\n        Contents() {\n          reference(contents);\n        },\n        MediaBox() {\n          array(() => {\n            number(0);\n            number(0);\n            number(width);\n            number(height);\n          });\n        }\n      });\n    });\n    return page;\n  }));\n\n  const pageRoot = object(() => {\n    dict({\n      Type() {\n        name('Pages');\n      },\n      Kids() {\n        array(() => {\n          for (const page of pages) {\n            reference(page);\n          }\n        });\n      },\n      Count() {\n        number(pages.length);\n      }\n    })\n  });\n\n  const catalog = object(() => {\n    dict({\n      Type() {\n        name('Catalog');\n      },\n      Pages() {\n        reference(pageRoot);\n      }\n    });\n  });\n\n  // XREF\n  write('\\n');\n  const xrefOffset = index;\n  write('xref\\n0 ' + (offsets.length + 1) + '\\n0000000000 65535 f \\n');\n  for (const offset of offsets) {\n    write(offset.toString().padStart(10, '0') + ' 00000 n \\n');\n  }\n  write('trailer');\n  dict({\n    Size() {\n      number(offsets.length + 1);\n    },\n    Root() {\n      reference(catalog);\n    }\n  });\n  write('\\nstartxref\\n' + xrefOffset + '\\n%%EOF');\n  return concat(pdfChunks);\n}","import { bitmapToData } from './process';\n\nexport const toImage = async (img: Blob) => {\n  const elem = document.createElement('img');\n  const loaded = new Promise<void>((resolve, reject) => {\n    elem.onload = () => { resolve(); };\n    elem.onerror = err => { reject(err); };\n  });\n  elem.src = URL.createObjectURL(img);\n  await loaded;\n  URL.revokeObjectURL(elem.src);\n  return elem;\n}\n\nconst sharedCanvas = document.createElement('canvas');\nconst sharedCtx = sharedCanvas.getContext('2d')!\n\nexport const getData = async (img: ImageBitmap | HTMLImageElement, transfer?: boolean) => {\n  if (sharedCanvas['transferControlToOffscreen' as 'getContext']) {\n    return bitmapToData(img instanceof ImageBitmap ? img : await createImageBitmap(img), transfer);\n  }\n  sharedCanvas.width = img.width, sharedCanvas.height = img.height;\n  sharedCtx.drawImage(img, 0, 0);\n  return sharedCtx.getImageData(0, 0, img.width, img.height);\n}\n\nexport const download = (file: Blob, name: string) => {\n  const url = URL.createObjectURL(file);\n  const el = document.createElement('a');\n  el.download = name;\n  el.href = url;\n  el.click();\n  URL.revokeObjectURL(url);\n}\n","module.exports = new __parcel__URL__(require('./helpers/bundle-manifest').resolve(\"bj76Q\")).toString();","module.exports = new __parcel__URL__(require('./helpers/bundle-manifest').resolve(\"e0Dy9\")).toString();","module.exports = new __parcel__URL__(require('./helpers/bundle-manifest').resolve(\"lX2gi\")).toString();","module.exports = new __parcel__URL__(require('./helpers/bundle-manifest').resolve(\"gltHY\")).toString();","/**\n * MediaStream ImageCapture polyfill\n *\n * @license\n * Copyright 2018 Google Inc.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nexport let ImageCapture = window.ImageCapture;\n\nif (typeof ImageCapture === 'undefined') {\n  ImageCapture = class {\n\n    /**\n     * TODO https://www.w3.org/TR/image-capture/#constructors\n     *\n     * @param {MediaStreamTrack} videoStreamTrack - A MediaStreamTrack of the 'video' kind\n     */\n    constructor(videoStreamTrack) {\n      if (videoStreamTrack.kind !== 'video')\n        throw new DOMException('NotSupportedError');\n\n      this._videoStreamTrack = videoStreamTrack;\n      if (!('readyState' in this._videoStreamTrack)) {\n        // Polyfill for Firefox\n        this._videoStreamTrack.readyState = 'live';\n      }\n\n      // MediaStream constructor not available until Chrome 55 - https://www.chromestatus.com/feature/5912172546752512\n      this._previewStream = new MediaStream([videoStreamTrack]);\n      this.videoElement = document.createElement('video');\n      this.videoElementPlaying = new Promise(resolve => {\n        this.videoElement.addEventListener('playing', resolve);\n      });\n      if (HTMLMediaElement) {\n        this.videoElement.srcObject = this._previewStream;  // Safari 11 doesn't allow use of createObjectURL for MediaStream\n      } else {\n        this.videoElement.src = URL.createObjectURL(this._previewStream);\n      }\n      this.videoElement.muted = true;\n      this.videoElement.setAttribute('playsinline', ''); // Required by Safari on iOS 11. See https://webkit.org/blog/6784\n      this.videoElement.play();\n\n      this.canvasElement = document.createElement('canvas');\n      // TODO Firefox has https://developer.mozilla.org/en-US/docs/Web/API/OffscreenCanvas\n      this.canvas2dContext = this.canvasElement.getContext('2d');\n    }\n\n    /**\n     * https://w3c.github.io/mediacapture-image/index.html#dom-imagecapture-videostreamtrack\n     * @return {MediaStreamTrack} The MediaStreamTrack passed into the constructor\n     */\n    get videoStreamTrack() {\n      return this._videoStreamTrack;\n    }\n\n    /**\n     * Implements https://www.w3.org/TR/image-capture/#dom-imagecapture-getphotocapabilities\n     * @return {Promise<PhotoCapabilities>} Fulfilled promise with\n     * [PhotoCapabilities](https://www.w3.org/TR/image-capture/#idl-def-photocapabilities)\n     * object on success, rejected promise on failure\n     */\n    getPhotoCapabilities() {\n      return new Promise(function executorGPC(resolve, reject) {\n        // TODO see https://github.com/w3c/mediacapture-image/issues/97\n        const MediaSettingsRange = {\n          current: 0, min: 0, max: 0,\n        };\n        resolve({\n          exposureCompensation: MediaSettingsRange,\n          exposureMode: 'none',\n          fillLightMode: 'none',\n          focusMode: 'none',\n          imageHeight: MediaSettingsRange,\n          imageWidth: MediaSettingsRange,\n          iso: MediaSettingsRange,\n          redEyeReduction: false,\n          whiteBalanceMode: 'none',\n          zoom: MediaSettingsRange,\n        });\n        reject(new DOMException('OperationError'));\n      });\n    }\n\n    /**\n     * Implements https://www.w3.org/TR/image-capture/#dom-imagecapture-setoptions\n     * @param {Object} photoSettings - Photo settings dictionary, https://www.w3.org/TR/image-capture/#idl-def-photosettings\n     * @return {Promise<void>} Fulfilled promise on success, rejected promise on failure\n     */\n    setOptions(photoSettings = {}) {\n      return new Promise(function executorSO(resolve, reject) {\n        // TODO\n      });\n    }\n\n    /**\n     * TODO\n     * Implements https://www.w3.org/TR/image-capture/#dom-imagecapture-takephoto\n     * @return {Promise<Blob>} Fulfilled promise with [Blob](https://www.w3.org/TR/FileAPI/#blob)\n     * argument on success; rejected promise on failure\n     */\n    takePhoto() {\n      const self = this;\n      return new Promise(function executorTP(resolve, reject) {\n        // `If the readyState of the MediaStreamTrack provided in the constructor is not live,\n        // return a promise rejected with a new DOMException whose name is \"InvalidStateError\".`\n        if (self._videoStreamTrack.readyState !== 'live') {\n          return reject(new DOMException('InvalidStateError'));\n        }\n        self.videoElementPlaying.then(() => {\n          try {\n            self.canvasElement.width = self.videoElement.videoWidth;\n            self.canvasElement.height = self.videoElement.videoHeight;\n            self.canvas2dContext.drawImage(self.videoElement, 0, 0);\n            self.canvasElement.toBlob(resolve);\n          } catch (error) {\n            reject(new DOMException('UnknownError'));\n          }\n        });\n      });\n    }\n\n    /**\n     * Implements https://www.w3.org/TR/image-capture/#dom-imagecapture-grabframe\n     * @return {Promise<ImageBitmap>} Fulfilled promise with\n     * [ImageBitmap](https://www.w3.org/TR/html51/webappapis.html#webappapis-images)\n     * argument on success; rejected promise on failure\n     */\n    grabFrame() {\n      const self = this;\n      return new Promise(function executorGF(resolve, reject) {\n        // `If the readyState of the MediaStreamTrack provided in the constructor is not live,\n        // return a promise rejected with a new DOMException whose name is \"InvalidStateError\".`\n        if (self._videoStreamTrack.readyState !== 'live') {\n          return reject(new DOMException('InvalidStateError'));\n        }\n        self.videoElementPlaying.then(() => {\n          try {\n            self.canvasElement.width = self.videoElement.videoWidth;\n            self.canvasElement.height = self.videoElement.videoHeight;\n            self.canvas2dContext.drawImage(self.videoElement, 0, 0);\n            // TODO polyfill https://developer.mozilla.org/en-US/docs/Web/API/ImageBitmapFactories/createImageBitmap for IE\n            resolve(window.createImageBitmap(self.canvasElement));\n          } catch (error) {\n            reject(new DOMException('UnknownError'));\n          }\n        });\n      });\n    }\n  };\n}\n\nwindow.ImageCapture = ImageCapture;\n","module.exports = new __parcel__URL__(\"workers/\" + require('./helpers/bundle-manifest').resolve(\"drXuR\")).toString();"],"names":["$b4e14b6b8da86996$var$defaultMaxRes","$parcel$export","e","n","v","s","Object","defineProperty","get","set","enumerable","configurable","$parcel$interopDefault","a","__esModule","default","$parcel$global","globalThis","self","window","global","$parcel$modules","$parcel$inits","parcelRequire","id","exports","init","module","call","err","Error","code","register","$18c11f3350a906ea$export$6503ec6e8aabbaf","$18c11f3350a906ea$export$f7ad0328861e2f03","$18c11f3350a906ea$var$mapping","pairs","keys","i","length","resolved","JSON","parse","$c75b7671c945b972$exports","$56b621a6dd25b2cb$exports","workerUrl","origin","isESM","location","source","stringify","URL","createObjectURL","Blob","type","$c75b7671c945b972$var$url","resolve","url","toString","$191e7775e3189472$var$newWorker","Worker","$191e7775e3189472$var$processWorkers","navigator","hardwareConcurrency","push","$191e7775e3189472$var$getWorker","pop","$191e7775e3189472$var$returnWorker","worker","$191e7775e3189472$var$messageID","$191e7775e3189472$var$message","msg","transfer","Promise","reject","onMessage","evt","mid","error","result","data","message","stack","name","removeEventListener","addEventListener","postMessage","$191e7775e3189472$export$c5fefc891e91de4b","buffer","$98ce8732f7dffb75$var$readFile","prototype","arrayBuffer","fr","FileReader","onload","onerror","readAsArrayBuffer","$98ce8732f7dffb75$export$99fdcdff3bb1ad24","images","pdfChunks","index","offsets","write","chunk","token","concat","chunks","len","buf","Uint8Array","charCodeAt","comment","content","number","value","array","fn","dict","values","key","stream","desc","object","reference","pages","all","map","img","canvas","document","createElement","width","height","getContext","putImageData","jpeg","toBlob","jpegData","image","Type","Subtype","Width","Height","ColorSpace","BitsPerComponent","Filter","Length","contents","page","Parent","Resources","XObject","I","Contents","MediaBox","pageRoot","Kids","Count","catalog","Pages","xrefOffset","offset","padStart","Size","Root","$aa7f0fbc084e0a0e$export$85ada9a21afbeab6","elem","loaded","src","revokeObjectURL","$aa7f0fbc084e0a0e$var$sharedCanvas","$aa7f0fbc084e0a0e$var$sharedCtx","$aa7f0fbc084e0a0e$export$7a171f172be0782e","bitmap","ImageBitmap","createImageBitmap","drawImage","getImageData","$aa7f0fbc084e0a0e$export$24422be91ad4011f","file","el","download","href","click","$5680d29e5f9eab67$exports","$bb74cf2efca2bea5$exports","$009ec47ee18c0b40$exports","$954630f75b1da243$exports","$0e4bd8b916ae6e46$export$d2caa7debd66c3ef","ImageCapture","constructor","videoStreamTrack","kind","DOMException","_videoStreamTrack","readyState","_previewStream","MediaStream","videoElement","videoElementPlaying","HTMLMediaElement","srcObject","muted","setAttribute","play","canvasElement","canvas2dContext","getPhotoCapabilities","MediaSettingsRange","current","min","max","exposureCompensation","exposureMode","fillLightMode","focusMode","imageHeight","imageWidth","iso","redEyeReduction","whiteBalanceMode","zoom","setOptions","photoSettings","takePhoto","then","videoWidth","videoHeight","grabFrame","$b4e14b6b8da86996$var$root","getElementById","$b4e14b6b8da86996$var$modal","$b4e14b6b8da86996$var$captures","$b4e14b6b8da86996$var$preview","$b4e14b6b8da86996$var$previewCrop","$b4e14b6b8da86996$var$previewDoc","$b4e14b6b8da86996$var$bottomWrapper","$b4e14b6b8da86996$var$topWrapper","$b4e14b6b8da86996$var$selectWrapper","$b4e14b6b8da86996$var$select","$b4e14b6b8da86996$var$qualityWrapper","$b4e14b6b8da86996$var$quality","$b4e14b6b8da86996$var$qualityImg","$b4e14b6b8da86996$var$githubWrapper","$b4e14b6b8da86996$var$flashWrapper","$b4e14b6b8da86996$var$flash","$b4e14b6b8da86996$var$flashImg","$b4e14b6b8da86996$var$pastWrapper","$b4e14b6b8da86996$var$past","$b4e14b6b8da86996$var$uploadWrapper","$b4e14b6b8da86996$var$upload","$b4e14b6b8da86996$var$shutter","$b4e14b6b8da86996$var$doneWrapper","$b4e14b6b8da86996$var$done","$b4e14b6b8da86996$var$modalBottomWrapper","$b4e14b6b8da86996$var$modalCancelWrapper","$b4e14b6b8da86996$var$modalCancel","$b4e14b6b8da86996$var$modalDoneWrapper","$b4e14b6b8da86996$var$modalDone","$b4e14b6b8da86996$var$maxRes","$b4e14b6b8da86996$var$pages","$b4e14b6b8da86996$var$resizeListeners","$b4e14b6b8da86996$var$onResize","listener","splice","indexOf","$b4e14b6b8da86996$var$callResizeListeners","$b4e14b6b8da86996$var$rst","clearTimeout","setTimeout","passive","$b4e14b6b8da86996$var$getMaxRes","device","constraints","facingMode","deviceId","exact","prom","mediaDevices","getUserMedia","video","media","settings","getVideoTracks","getSettings","track","getTracks","stop","Math","val","$b4e14b6b8da86996$var$point","scale","mwh","innerWidth","innerHeight","style","borderRadius","backgroundColor","position","$b4e14b6b8da86996$var$adjustPoint","top","y","left","x","$b4e14b6b8da86996$var$line","b","transformOrigin","$b4e14b6b8da86996$var$adjustLine","hypot","transform","atan2","$b4e14b6b8da86996$var$preprocessPhoto","cnv","quad","c","d","clampPoint","$b4e14b6b8da86996$var$processPhotos","srcs","results","cbs","firstDimensions","landscape","isFirst","isLast","imgCrop","display","justifyContent","alignItems","overflow","scrollSnapAlign","imgDoc","appendChild","aspectRatio","docX","docY","latestDims","prevElems","getLatestDims","getBoundingClientRect","makePoint","onUpdate","pt","active","onDown","parentElement","target","stopImmediatePropagation","onMove","onMouseDown","onTouchStart","onMouseMove","onTouchMove","onUp","pageX","pageY","touch","targetTouches","preventDefault","paintLines","removeChild","ab","bc","cd","da","updateImageDimensions","$b4e14b6b8da86996$var$calcDimensions","$b4e14b6b8da86996$var$isLandscape","margin","flexDirection","cssWidth","cssHeight","minWidth","minHeight","offResize","check","opacity","lastChild","onDone","finish","onCancel","cb","maxRatio","floor","$b4e14b6b8da86996$var$sideWrappers","$b4e14b6b8da86996$var$topElems","$b4e14b6b8da86996$var$bottomElems","$b4e14b6b8da86996$var$allElems","$b4e14b6b8da86996$var$startStream","maxRes","sideWrapper","topElem","bottomElem","pastBorderSize","border","videoTrack","capabilities","getCapabilities","torch","newElems","clearNewElems","onMetadata","docPreview","ts","performance","now","cap","docPreviewTimeout","hd","onQualityClick","shutterFlash","onShutterClick","photo","onFlashClick","applyConstraints","advanced","close","pause","$b4e14b6b8da86996$var$onLoad","localStorage","getItem","updateBold","option","options","fontWeight","selectedOptions","enumerateDevices","label","update","disabled","setItem","onchange","files","onclick","region","targetWidth","currPages","slice","$6d2b58ea9d1b18f4$exports","serviceWorker"],"version":3,"file":"index.ec5a4b7d.js.map"}