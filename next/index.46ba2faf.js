function e(e,t,n,i){Object.defineProperty(e,t,{get:n,set:i,enumerable:!0,configurable:!0})}function t(e){return e&&e.__esModule?e.default:e}var n="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof global?global:{},i={},r={},o=n.parcelRequireed96;let a;null==o&&((o=function(e){if(e in i)return i[e].exports;if(e in r){var t=r[e];delete r[e];var n={id:e,exports:{}};return i[e]=n,t.call(n.exports,n,n.exports),n.exports}var o=new Error("Cannot find module '"+e+"'");throw o.code="MODULE_NOT_FOUND",o}).register=function(e,t){r[e]=t},n.parcelRequireed96=o),o.register("bXuNP",(function(t,n){var i,r;e(t.exports,"register",(()=>i),(e=>i=e)),e(t.exports,"resolve",(()=>r),(e=>r=e));var o={};i=function(e){for(var t=Object.keys(e),n=0;n<t.length;n++)o[t[n]]=e[t[n]]},r=function(e){var t=o[e];if(null==t)throw new Error("Could not resolve bundle with id "+e);return t}})),o("bXuNP").register(JSON.parse('{"d3X8m":"index.46ba2faf.js","8plmg":"scanner_bg.52ddf46a.wasm","hSxXa":"process.0414266e.js","9Zhps":"flash.7ae5cfb8.svg","aPRWI":"flash-off.f95884b2.svg","iiC8o":"hd.0cfe4ff9.svg","8qWZp":"sd.25c2f123.svg","HMBE2":"service.js"}'));const s=new Array(32).fill(void 0);function d(e){return s[e]}s.push(void 0,null,!0,!1);let c=s.length;function l(e){const t=d(e);return function(e){e<36||(s[e]=c,c=e)}(e),t}function h(e){const t=typeof e;if("number"==t||"boolean"==t||null==e)return`${e}`;if("string"==t)return`"${e}"`;if("symbol"==t){const t=e.description;return null==t?"Symbol":`Symbol(${t})`}if("function"==t){const t=e.name;return"string"==typeof t&&t.length>0?`Function(${t})`:"Function"}if(Array.isArray(e)){const t=e.length;let n="[";t>0&&(n+=h(e[0]));for(let i=1;i<t;i++)n+=", "+h(e[i]);return n+="]",n}const n=/\[object ([^\]]+)\]/.exec(toString.call(e));let i;if(!(n.length>1))return toString.call(e);if(i=n[1],"Object"==i)try{return"Object("+JSON.stringify(e)+")"}catch(e){return"Object"}return e instanceof Error?`${e.name}: ${e.message}\n${e.stack}`:i}let g=0,u=null;function m(){return null!==u&&u.buffer===a.memory.buffer||(u=new Uint8Array(a.memory.buffer)),u}let w=new TextEncoder("utf-8");const p="function"==typeof w.encodeInto?function(e,t){return w.encodeInto(e,t)}:function(e,t){const n=w.encode(e);return t.set(n),{read:e.length,written:n.length}};let y=null;function f(){return null!==y&&y.buffer===a.memory.buffer||(y=new Int32Array(a.memory.buffer)),y}let v=new TextDecoder("utf-8",{ignoreBOM:!0,fatal:!0});function b(e,t){if(!(e instanceof t))throw new Error(`expected instance of ${t.name}`);return e.ptr}function _(e){c===s.length&&s.push(s.length+1);const t=c;return c=s[t],s[t]=e,t}function E(e){return null==e}v.decode();let x=null;function I(e,t){return(null!==x&&x.buffer===a.memory.buffer||(x=new Uint8ClampedArray(a.memory.buffer)),x).subarray(e/1,e/1+t)}function C(e,t){try{return e.apply(this,t)}catch(e){a.__wbindgen_exn_store(_(e))}}class B{static __wrap(e){const t=Object.create(B.prototype);return t.ptr=e,t}__destroy_into_raw(){const e=this.ptr;return this.ptr=0,e}free(){const e=this.__destroy_into_raw();a.__wbg_point_free(e)}get x(){return a.__wbg_get_point_x(this.ptr)}set x(e){a.__wbg_set_point_x(this.ptr,e)}get y(){return a.__wbg_get_point_y(this.ptr)}set y(e){a.__wbg_set_point_y(this.ptr,e)}}class k{static __wrap(e){const t=Object.create(k.prototype);return t.ptr=e,t}__destroy_into_raw(){const e=this.ptr;return this.ptr=0,e}free(){const e=this.__destroy_into_raw();a.__wbg_quad_free(e)}get a(){var e=a.__wbg_get_quad_a(this.ptr);return B.__wrap(e)}set a(e){b(e,B);var t=e.ptr;e.ptr=0,a.__wbg_set_quad_a(this.ptr,t)}get b(){var e=a.__wbg_get_quad_b(this.ptr);return B.__wrap(e)}set b(e){b(e,B);var t=e.ptr;e.ptr=0,a.__wbg_set_quad_b(this.ptr,t)}get c(){var e=a.__wbg_get_quad_c(this.ptr);return B.__wrap(e)}set c(e){b(e,B);var t=e.ptr;e.ptr=0,a.__wbg_set_quad_c(this.ptr,t)}get d(){var e=a.__wbg_get_quad_d(this.ptr);return B.__wrap(e)}set d(e){b(e,B);var t=e.ptr;e.ptr=0,a.__wbg_set_quad_d(this.ptr,t)}constructor(e,t,n,i,r,o,s,d){var c=a.quad_new(e,t,n,i,r,o,s,d);return k.__wrap(c)}}var L;o.register("kPq84",(function(t,n){var i,r;e(t.exports,"getBundleURL",(()=>i),(e=>i=e)),e(t.exports,"getOrigin",(()=>r),(e=>r=e));var o={};function a(e){return(""+e).replace(/^((?:https?|file|ftp):\/\/.+)\/[^/]+$/,"$1")+"/"}i=function(e){var t=o[e];return t||(t=function(){try{throw new Error}catch(t){var e=(""+t.stack).match(/(https?|file|ftp):\/\/[^)\n]+/g);if(e)return a(e[2])}return"/"}(),o[e]=t),t},r=function(e){var t=(""+e).match(/(https?|file|ftp):\/\/[^/]+/);if(!t)throw new Error("Origin not found");return t[0]}})),L=o("kPq84").getBundleURL("d3X8m")+o("bXuNP").resolve("8plmg");var S=async function e(t){void 0===t&&(t=new URL(L));const n={wbg:{}};n.wbg.__wbg_width_16bd64d09cbf5661=function(e){return d(e).width},n.wbg.__wbg_height_368bb86c37d51bc9=function(e){return d(e).height},n.wbg.__wbg_data_1ae7496c58caf755=function(e,t){var n=function(e,t){const n=t(1*e.length);return m().set(e,n/1),g=e.length,n}(d(t).data,a.__wbindgen_malloc),i=g;f()[e/4+1]=i,f()[e/4+0]=n},n.wbg.__wbindgen_object_drop_ref=function(e){l(e)},n.wbg.__wbg_newwithu8clampedarrayandsh_1b8c6e1bede43657=function(){return C((function(e,t,n,i){return _(new ImageData(I(e,t),n>>>0,i>>>0))}),arguments)},n.wbg.__wbindgen_debug_string=function(e,t){var n=function(e,t,n){if(void 0===n){const n=w.encode(e),i=t(n.length);return m().subarray(i,i+n.length).set(n),g=n.length,i}let i=e.length,r=t(i);const o=m();let a=0;for(;a<i;a++){const t=e.charCodeAt(a);if(t>127)break;o[r+a]=t}if(a!==i){0!==a&&(e=e.slice(a)),r=n(r,i,i=a+3*e.length);const t=m().subarray(r+a,r+i);a+=p(e,t).written}return g=a,r}(h(d(t)),a.__wbindgen_malloc,a.__wbindgen_realloc),i=g;f()[e/4+1]=i,f()[e/4+0]=n},n.wbg.__wbindgen_throw=function(e,t){throw new Error((n=e,i=t,v.decode(m().subarray(n,n+i))));var n,i},("string"==typeof t||"function"==typeof Request&&t instanceof Request||"function"==typeof URL&&t instanceof URL)&&(t=fetch(t));const{instance:i,module:r}=await async function(e,t){if("function"==typeof Response&&e instanceof Response){if("function"==typeof WebAssembly.instantiateStreaming)try{return await WebAssembly.instantiateStreaming(e,t)}catch(t){if("application/wasm"==e.headers.get("Content-Type"))throw t;console.warn("`WebAssembly.instantiateStreaming` failed because your server does not serve wasm with `application/wasm` MIME type. Falling back to `WebAssembly.instantiate` which is slower. Original error:\n",t)}const n=await e.arrayBuffer();return await WebAssembly.instantiate(n,t)}{const n=await WebAssembly.instantiate(e,t);return n instanceof WebAssembly.Instance?{instance:n,module:e}:n}}(await t,n);return a=i.exports,e.__wbindgen_wasm_module=r,a};const R=e=>{if("find-document"==e.type){const i=(t=e.data,0===(n=a.find_document(_(t)))?void 0:k.__wrap(n));return{result:i&&{a:{x:i.a.x,y:i.a.y},b:{x:i.b.x,y:i.b.y},c:{x:i.c.x,y:i.c.y},d:{x:i.d.x,y:i.d.y}}}}if("extract-document"==e.type){const{a:t,b:n,c:i,d:r}=e.region,o=new k(t.x,t.y,n.x,n.y,i.x,i.y,r.x,r.y),s=function(e,t,n,i){b(t,k);var r=t.ptr;return t.ptr=0,l(a.extract_document(_(e),r,n,!E(i),E(i)?0:i))}(e.data,o,e.targetWidth,e.targetHeight);return{result:s}}if("get-data"==e.type){const{width:t,height:n}=e.bitmap,i=new OffscreenCanvas(t,n).getContext("2d");i.drawImage(e.bitmap,0,0);return{result:i.getImageData(0,0,t,n)}}throw new TypeError("invalid message");var t,n};let H=S().catch((()=>{}));onmessage=async e=>{await H;const{msg:t,...n}=e.data;try{const{result:e,transfer:i}=R(t);postMessage({result:e,...n},i||[])}catch(e){e instanceof Error||(e=new Error(`Error in process worker: ${e}`)),postMessage({error:{message:e.message,stack:e.stack,name:e.name},...n})}};var P,O;O=function(e,t,n){if(t===self.location.origin)return e;var i=n?"import "+JSON.stringify(e)+";":"importScripts("+JSON.stringify(e)+");";return URL.createObjectURL(new Blob([i],{type:"application/javascript"}))};var W=o("kPq84");let M=W.getBundleURL("d3X8m")+o("bXuNP").resolve("hSxXa");P=O(M,W.getOrigin(M),!0);const D=()=>new Worker(P,{type:"module"}),T=[];if(navigator.hardwareConcurrency)for(let e=1;e<navigator.hardwareConcurrency;++e)T.push(D());let U=0;const q=async(e,t)=>new Promise(((n,i)=>{const r=T.pop()||D();let o=U++;const a=e=>{const{id:t,error:s,result:d}=e.data;if(t==o){if(s){let e=new Error(s.message);e.stack=s.stack,e.name=s.name,i(e)}else n(d);(e=>{T.push(e)})(r),r.removeEventListener("message",a)}};r.addEventListener("message",a),r.postMessage({id:o,msg:e},t||[])}));function j(e,t){return q({type:"find-document",data:e},t?[e.data.buffer]:[])}const A=Blob.prototype.arrayBuffer||function(){return new Promise(((e,t)=>{const n=new FileReader;n.onload=()=>{e(n.result)},n.onerror=()=>{t(n.error)},n.readAsArrayBuffer(this)}))},X=async e=>{const t=[];let n=0;const i=[],r=e=>{t.push(e),n+=e.length},o=e=>{r(" "),r(e)},a=e=>{let t=0;for(const n of e)t+=n.length;const n=new Uint8Array(t);t=0;for(const i of e){if("string"==typeof i)for(let e=0;e<i.length;++e)n[e+t]=i.charCodeAt(e);else n.set(i,t);t+=i.length}return n},s=e=>{r("%"+e+"\n")},d=e=>{o(e.toString())},c=e=>{o("/"+e)},l=e=>{o("["),e(),o("]")},h=e=>{o("<<");for(const t in e)c(t),e[t]();o(">>")},g=(e,t)=>{h(e),o("stream\n"),r(t),r("endstream")},u=e=>(r(" "),r(i.push(n)+" 0 obj"),e(),o("endobj"),i.length),m=e=>{o(e+" 0 R")};s("PDF-1.4"),s("úã");const w=await Promise.all(e.map((async e=>{const t=document.createElement("canvas");t.width=e.width,t.height=e.height,t.getContext("2d").putImageData(e,0,0);const n=await new Promise((e=>t.toBlob(e,"image/jpeg"))),r=new Uint8Array(await A.call(n)),o=u((()=>{g({Type(){c("XObject")},Subtype(){c("Image")},Width(){d(e.width)},Height(){d(e.height)},ColorSpace(){c("DeviceRGB")},BitsPerComponent(){d(8)},Filter(){c("DCTDecode")},Length(){d(r.length)}},r)})),s=792*e.width/e.height,w=u((()=>{const e=`${s} 0 0 792 0 0 cm /I Do`;g({Length(){d(e.length)}},a([e]))}));return u((()=>{h({Type(){c("Page")},Parent(){m(i.length+1)},Resources(){h({XObject(){h({I(){m(o)}})}})},Contents(){m(w)},MediaBox(){l((()=>{d(0),d(0),d(s),d(792)}))}})}))}))),p=u((()=>{h({Type(){c("Pages")},Kids(){l((()=>{for(const e of w)m(e)}))},Count(){d(w.length)}})})),y=u((()=>{h({Type(){c("Catalog")},Pages(){m(p)}})}));r("\n");const f=n;r("xref\n0 "+(i.length+1)+"\n0000000000 65535 f \n");for(const e of i)r(e.toString().padStart(10,"0")+" 00000 n \n");return r("trailer"),h({Size(){d(i.length+1)},Root(){m(y)}}),r("\nstartxref\n"+f+"\n%%EOF"),a(t)},F=document.createElement("canvas"),N=F.getContext("2d"),$=async(e,t)=>F.transferControlToOffscreen?function(e,t){return q({type:"get-data",bitmap:e},t?[e]:[])}(e instanceof ImageBitmap?e:await createImageBitmap(e),t):(F.width=e.width,F.height=e.height,N.drawImage(e,0,0),N.getImageData(0,0,e.width,e.height));var J;J=o("kPq84").getBundleURL("d3X8m")+o("bXuNP").resolve("9Zhps");var Y;Y=o("kPq84").getBundleURL("d3X8m")+o("bXuNP").resolve("aPRWI");var Z;Z=o("kPq84").getBundleURL("d3X8m")+o("bXuNP").resolve("iiC8o");var z;z=o("kPq84").getBundleURL("d3X8m")+o("bXuNP").resolve("8qWZp");let V=window.ImageCapture;void 0===V&&(V=class{constructor(e){if("video"!==e.kind)throw new DOMException("NotSupportedError");this._videoStreamTrack=e,"readyState"in this._videoStreamTrack||(this._videoStreamTrack.readyState="live"),this._previewStream=new MediaStream([e]),this.videoElement=document.createElement("video"),this.videoElementPlaying=new Promise((e=>{this.videoElement.addEventListener("playing",e)})),HTMLMediaElement?this.videoElement.srcObject=this._previewStream:this.videoElement.src=URL.createObjectURL(this._previewStream),this.videoElement.muted=!0,this.videoElement.setAttribute("playsinline",""),this.videoElement.play(),this.canvasElement=document.createElement("canvas"),this.canvas2dContext=this.canvasElement.getContext("2d")}get videoStreamTrack(){return this._videoStreamTrack}getPhotoCapabilities(){return new Promise((function(e,t){const n={current:0,min:0,max:0};e({exposureCompensation:n,exposureMode:"none",fillLightMode:"none",focusMode:"none",imageHeight:n,imageWidth:n,iso:n,redEyeReduction:!1,whiteBalanceMode:"none",zoom:n}),t(new DOMException("OperationError"))}))}setOptions(e={}){return new Promise((function(e,t){}))}takePhoto(){const e=this;return new Promise((function(t,n){if("live"!==e._videoStreamTrack.readyState)return n(new DOMException("InvalidStateError"));e.videoElementPlaying.then((()=>{try{e.canvasElement.width=e.videoElement.videoWidth,e.canvasElement.height=e.videoElement.videoHeight,e.canvas2dContext.drawImage(e.videoElement,0,0),e.canvasElement.toBlob(t)}catch(e){n(new DOMException("UnknownError"))}}))}))}grabFrame(){const e=this;return new Promise((function(t,n){if("live"!==e._videoStreamTrack.readyState)return n(new DOMException("InvalidStateError"));e.videoElementPlaying.then((()=>{try{e.canvasElement.width=e.videoElement.videoWidth,e.canvasElement.height=e.videoElement.videoHeight,e.canvas2dContext.drawImage(e.videoElement,0,0),t(window.createImageBitmap(e.canvasElement))}catch(e){n(new DOMException("UnknownError"))}}))}))}}),window.ImageCapture=V;const G=document.getElementById("root"),K=document.getElementById("modal"),Q=document.getElementById("captures"),ee=document.getElementById("preview"),te=document.getElementById("preview-crop"),ne=document.getElementById("preview-doc"),ie=document.getElementById("bottom-wrapper"),re=document.getElementById("top-wrapper"),oe=document.getElementById("camera-select-wrapper"),ae=document.getElementById("camera-select"),se=document.getElementById("quality-wrapper"),de=document.getElementById("quality"),ce=document.getElementById("quality-img"),le=document.getElementById("github-wrapper"),he=document.getElementById("flash-wrapper"),ge=document.getElementById("flash"),ue=document.getElementById("flash-img"),me=document.getElementById("past-wrapper"),we=document.getElementById("past"),pe=document.getElementById("upload-wrapper"),ye=document.getElementById("upload"),fe=document.getElementById("shutter"),ve=document.getElementById("done-wrapper"),be=document.getElementById("done"),_e=document.getElementById("modal-bottom-wrapper"),Ee=document.getElementById("modal-cancel-wrapper"),xe=document.getElementById("modal-cancel"),Ie=document.getElementById("modal-done-wrapper"),Ce=document.getElementById("modal-done");let Be,ke={};const Le=[],Se=[],Re=e=>(Se.push(e),()=>{Se.splice(Se.indexOf(e),1)}),He=()=>{for(const e of Se)e()};let Pe=-1;window.addEventListener("resize",(()=>{clearTimeout(Pe),Pe=setTimeout(He,250)}),{passive:!0});const Oe=(e,t)=>{const n=document.createElement("div"),i=Math.min(window.innerWidth,window.innerHeight);return n.style.width=.03*i+"px",n.style.height=.03*i+"px",n.style.borderRadius=.015*i+"px",n.style.backgroundColor="black",n.style.position="absolute",We(n,e,t),n},We=(e,t,n)=>{const i=Math.min(window.innerWidth,window.innerHeight);e.style.top=t.y*n-.015*i+"px",e.style.left=t.x*n-.015*i+"px"},Me=(e,t,n)=>{const i=document.createElement("div");return i.style.height="4px",i.style.backgroundColor="red",i.style.position="absolute",i.style.transformOrigin="center left",De(i,e,t,n),i},De=(e,t,n,i)=>{e.style.width=Math.hypot(t.x-n.x,t.y-n.y)*i+"px",e.style.top=t.y*i+"px",e.style.left=t.x*i+"px",e.style.transform=`rotate(${Math.atan2(n.y-t.y,n.x-t.x)}rad)`},Te=async e=>{let t,n;if(e instanceof Blob){const i=await(async e=>{const t=document.createElement("img"),n=new Promise(((e,n)=>{t.onload=()=>{e()},t.onerror=e=>{n(e)}}));return t.src=URL.createObjectURL(e),await n,URL.revokeObjectURL(t.src),t})(e);t=i,n=await $(i)}else{const i=document.createElement("canvas");i.width=e.width,i.height=e.height,i.getContext("2d").drawImage(e,0,0),t=i,n=await $(e,!0)}const i=await j(n)||{a:{x:0,y:n.height},b:{x:0,y:0},c:{x:n.width,y:0},d:{x:n.width,y:n.height}},r=e=>{e.x<0?e.x=0:e.x>n.width&&(e.x=n.width),e.y<0?e.y=0:e.y>n.height&&(e.y=n.height)};return r(i.a),r(i.b),r(i.c),r(i.d),{img:t,data:n,quad:i}},Ue=async e=>{const t=e.map((e=>e instanceof Blob||e instanceof ImageBitmap?Te(e):e)),n=[];let i={width:0,height:0},r=!1;for(const e of t){const o=e==t[0],a=e==t[t.length-1],{img:s,data:d,quad:c}=await e,l=document.createElement("div");l.style.display="flex",l.style.justifyContent="center",l.style.alignItems="center",l.style.overflow="hidden",l.style.scrollSnapAlign="center";const h=document.createElement("div");h.style.position="relative",h.appendChild(s),l.appendChild(h),K.style.display="flex";const g=Math.max(d.width,d.height)/Math.min(d.width,d.height);let u=0,m=0,w=0,p=!1,y=[];const f=()=>{if(!p){const{left:e,top:t}=h.getBoundingClientRect();m=e,w=t,p=!0}},v=(e,t)=>{const n=Oe(e,u);let i=!1;const r=(t,r,m)=>{n.parentElement==h?(t.target==n||t.target==s&&Math.hypot(r-e.x*u,m-e.y*u)<.2*Math.min(window.innerWidth,window.innerHeight))&&(t.stopImmediatePropagation(),i=!0,o(r,m)):(h.removeEventListener("mousedown",d),h.removeEventListener("touchstart",c),h.removeEventListener("mousemove",l),h.removeEventListener("touchmove",g),h.removeEventListener("mouseup",a),h.removeEventListener("touchend",a))},o=(i,r)=>{e.x=i/u,e.y=r/u,We(n,e,u),t()},a=()=>{i=!1},d=e=>{f(),r(e,e.pageX-m,e.pageY-w)};h.addEventListener("mousedown",d);const c=e=>{const t=e.targetTouches[0];f(),r(e,t.pageX-m,t.pageY-w)};h.addEventListener("touchstart",c);const l=e=>{i&&(e.preventDefault(),o(e.pageX-m,e.pageY-w))};h.addEventListener("mousemove",l);const g=e=>{if(i){const t=e.targetTouches[0];e.preventDefault(),o(t.pageX-m,t.pageY-w)}};return h.addEventListener("touchmove",g),h.addEventListener("mouseup",a),h.addEventListener("touchend",a),n},b=()=>{for(const e of y)h.removeChild(e);const e=Me(c.a,c.b,u),t=Me(c.b,c.c,u),n=Me(c.c,c.d,u),i=Me(c.d,c.a,u);y=[h.appendChild(e),h.appendChild(t),h.appendChild(n),h.appendChild(i),h.appendChild(v(c.a,(()=>{De(i,c.d,c.a,u),De(e,c.a,c.b,u)}))),h.appendChild(v(c.b,(()=>{De(e,c.a,c.b,u),De(t,c.b,c.c,u)}))),h.appendChild(v(c.c,(()=>{De(t,c.b,c.c,u),De(n,c.c,c.d,u)}))),h.appendChild(v(c.d,(()=>{De(n,c.c,c.d,u),De(i,c.d,c.a,u)})))]},_=()=>{const{width:e,height:t}=o?je(g,.925):i;o&&(r=qe(g),i={width:e,height:t},Ee.style.width=Ee.style.height=Ie.style.width=Ie.style.height=.035*(r?window.innerWidth:window.innerHeight)+"px",Ee.style.margin=Ie.style.margin=.02*(r?window.innerWidth:window.innerHeight)+"px",Q.style.width=K.style.width=window.innerWidth+"px",Q.style.height=K.style.height=window.innerHeight+"px",K.style.flexDirection=r?"row":"column",Q.style.flexDirection=r?"column":"row",r?(_e.style.flexDirection="column",_e.style.height=window.innerHeight+"px",_e.style.width=""):(_e.style.flexDirection="row",_e.style.height="",_e.style.width=window.innerWidth+"px"));const n=e+"px",a=t+"px";r?(s.style.width="",s.style.height=a,u=window.innerHeight/d.height):(s.style.width=n,s.style.height="",u=window.innerWidth/d.width),l.style.width=l.style.minWidth=n,l.style.height=l.style.minHeight=a,p=!1,b()};_(),Q.appendChild(l);const E=Re(_);n.push((e=>{if(e&&(Le.push({data:d,quad:c,img:s}),ve.style.opacity="",a)){for(s.width>s.height?(s.style.height=me.style.height,s.style.width=""):(s.style.height="",s.style.width=me.style.width);me.lastChild!=we;)me.removeChild(me.lastChild);me.appendChild(s)}E(),Q.removeChild(l)}))}return new Promise((e=>{const t=()=>r(!0),i=()=>r(!1);xe.addEventListener("click",i),Ce.addEventListener("click",t);const r=r=>{Ce.removeEventListener("click",t),xe.removeEventListener("click",i),K.style.display="none";for(const e of n)e(r);e(r)}}))},qe=e=>window.innerWidth>window.innerHeight*e,je=(e,t)=>{const n=qe(e),i=n?window.innerHeight:Math.floor(Math.min(window.innerWidth*e,window.innerHeight*t));return{width:n?Math.floor(Math.min(window.innerHeight*e,window.innerWidth*t)):window.innerWidth,height:i}},Ae=[re,ie],Xe=[he,se,le,oe,me],Fe=[ve,pe],Ne=Xe.concat(Fe,fe),$e=async e=>{const n=await(e=>{const t={width:1e5,height:1e5,facingMode:"environment"};if(e){if(ke[e])return ke[e];t.deviceId={exact:e}}else if(Be)return Be;const n=navigator.mediaDevices.getUserMedia({video:t}).then((e=>{const t=e.getVideoTracks()[0].getSettings();for(const t of e.getTracks())t.stop();return{width:Math.max(t.width,t.height),height:Math.min(t.width,t.height),deviceId:t.deviceId}}));return e?ke[e]=n:Be=n.then((e=>(ke[e.deviceId]=n,e))),n})(e);let i=n.width/n.height;const r=qe(i),{width:o,height:a}=je(i,.84),s=a+"px",d=o+"px";te.style.width=te.style.minWidth=d,te.style.height=te.style.minHeight=s,G.style.width=window.innerWidth+"px",G.style.height=window.innerHeight+"px";for(const e of Ae)r?(e.style.flexDirection="column",e.style.height=window.innerHeight+"px",e.style.width=""):(e.style.flexDirection="row",e.style.height="",e.style.width=window.innerWidth+"px");for(const e of Xe)e.style.width=e.style.height=.03*(r?window.innerWidth:window.innerHeight)+"px";for(const e of Fe)e.style.width=e.style.height=.035*(r?window.innerWidth:window.innerHeight)+"px";for(const e of Ne)e.style.margin=.02*(r?window.innerWidth:window.innerHeight)+"px";fe.style.width=fe.style.height=.05*(r?window.innerWidth:window.innerHeight)+"px";const c=.002*(r?window.innerWidth:window.innerHeight)+"px";me.style.borderRadius=c,me.style.border=c+" solid white",r?(ee.style.height=s,ee.style.width="",G.style.flexDirection="row"):(ee.style.height="",ee.style.width=d,G.style.flexDirection="column");const l={width:n.width,height:n.height,deviceId:{exact:n.deviceId}},h=await navigator.mediaDevices.getUserMedia({video:l}),g=h.getVideoTracks()[0],u=g.getCapabilities();he.style.display=u.torch?"":"none",ee.srcObject=h;let m=[];const w=()=>{const e=r?window.innerHeight/ee.videoHeight:window.innerWidth/ee.videoWidth,t=async()=>{let n;const i=performance.now();"none"==K.style.display&&(n=await j(await $(await p.grabFrame()),!0)),(()=>{for(const e of m)ne.removeChild(e);m.length=0})(),-1!=v&&(n&&(m=[ne.appendChild(Me(n.a,n.b,e)),ne.appendChild(Me(n.b,n.c,e)),ne.appendChild(Me(n.c,n.d,e)),ne.appendChild(Me(n.d,n.a,e))]),v=setTimeout(t,Math.max(250-performance.now()+i,0)))};v=setTimeout(t,0)};ee.addEventListener("loadedmetadata",w);const p=new ImageCapture(g);let y="[object ImageCapture]"==Object.prototype.toString.call(p);se.style.display=y?"":"none",ce.src=t(Z);const f=()=>{y=!y,ce.src=t(y?Z:z)};de.addEventListener("click",f);let v=-1;const b=async()=>{if(""==fe.style.opacity){fe.style.opacity="0.5",ee.style.opacity="0",setTimeout((()=>ee.style.opacity=""),50);try{const e=y?await p.takePhoto():await p.grabFrame();await Ue([e])}catch(e){}fe.style.opacity=""}};fe.addEventListener("click",b);let _=!1;ue.src=t(Y);const E=async()=>{try{_=!_,await g.applyConstraints({advanced:[{torch:_}]}),ue.src=t(_?J:Y)}catch(e){}};return ge.addEventListener("click",E),{deviceId:n.deviceId,close(){clearTimeout(v),v=-1,fe.removeEventListener("click",b),ge.removeEventListener("click",E),de.removeEventListener("click",f),ee.removeEventListener("loadedmetadata",w),ee.pause();for(const e of h.getTracks())e.stop()}}};(async()=>{let e=await $e(localStorage.getItem("defaultDevice"));const t=()=>{for(const e of ae.options)e.style.fontWeight="";ae.selectedOptions[0].style.fontWeight="bold"};for(const e of await navigator.mediaDevices.enumerateDevices())if("videoinput"==e.kind){const t=document.createElement("option");t.value=e.deviceId,t.label=e.label,ae.appendChild(t)}ae.value=e.deviceId,t();const n=async()=>{t(),e.close(),ae.disabled=!0,localStorage.setItem("defaultDevice",ae.value),e=await $e(ae.value),ae.disabled=!1};ae.onchange=n,Re(n),ye.onchange=async()=>{fe.style.opacity="0.5",await Ue([...ye.files]),fe.style.opacity=""},be.onclick=async()=>{if(Le.length){for(ve.style.opacity="0.5";me.lastChild!=we;)me.removeChild(me.lastChild);((e,t)=>{const n=URL.createObjectURL(e),i=document.createElement("a");i.download=t,i.href=n,i.click(),URL.revokeObjectURL(n)})(new Blob([await X(await Promise.all(Le.map((({data:e,quad:t})=>function(e,t,n,i){return q({type:"extract-document",data:e,region:t,targetWidth:n},i?[e.data.buffer]:[])}(e,t,1224,!0)))))]),"out.pdf"),Le.length=0}},we.onclick=async()=>{if(Le.length){const e=Le.slice();if(Le.length=0,!await Ue(e)){Le.push(...e);const{img:t}=e[e.length-1];for(t.width>t.height?(t.style.height=me.style.height,t.style.width=""):(t.style.height="",t.style.width=me.style.width);me.lastChild!=we;)me.removeChild(me.lastChild);me.appendChild(t)}}}})();var Je;Je=o("kPq84").getBundleURL("d3X8m")+"workers/"+o("bXuNP").resolve("HMBE2"),navigator.serviceWorker.register(Je);
//# sourceMappingURL=index.46ba2faf.js.map
