function t(t,e,o,n){Object.defineProperty(t,e,{get:o,set:n,enumerable:!0,configurable:!0})}var e="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof global?global:{},o={},n={},r=e.parcelRequireed96;null==r&&((r=function(t){if(t in o)return o[t].exports;if(t in n){var e=n[t];delete n[t];var r={id:t,exports:{}};return o[t]=r,e.call(r.exports,r,r.exports),r.exports}var a=new Error("Cannot find module '"+t+"'");throw a.code="MODULE_NOT_FOUND",a}).register=function(t,e){n[t]=e},e.parcelRequireed96=r),r.register("bXuNP",(function(e,o){var n,r;t(e.exports,"register",(()=>n),(t=>n=t)),t(e.exports,"resolve",(()=>r),(t=>r=t));var a={};n=function(t){for(var e=Object.keys(t),o=0;o<e.length;o++)a[e[o]]=t[e[o]]},r=function(t){var e=a[t];if(null==e)throw new Error("Could not resolve bundle with id "+t);return e}})),r("bXuNP").register(JSON.parse('{"lNt4Y":"index.3bdec287.js","4euQ1":"sw.js"}'));const a=Blob.prototype.arrayBuffer||function(){return new Promise(((t,e)=>{const o=new FileReader;o.onload=()=>{t(o.result)},o.onerror=()=>{e(o.error)},o.readAsArrayBuffer(this)}))},l=document.createElement("canvas"),s=l.getContext("2d"),c=(t,e,o)=>t<e?e:t>o?o:t,h=(t,e=new Float32Array(t.buffer,t.byteOffset,t.byteLength>>2))=>{for(let o=0;o<e.length;++o){const n=o<<2;e[o]=.00116796875*t[n]+.00229296875*t[n+1]+.0004453125*t[n+2]}return e},i=new Float32Array([.01258,.02516,.03145,.02516,.01258,.02516,.0566,.07547,.0566,.02516,.03145,.07547,.09434,.07547,.03145,.02516,.0566,.07547,.0566,.02516,.01258,.02516,.03145,.02516,.01258]),f=(t,e,o,n)=>((t,e,o,n,r,a=new Float32Array(t.length))=>{const l=1+(r<<1),s=o-l,h=e-l;for(let i=0;i<o;++i)for(let o=0;o<e;++o){let f=0;const y=c(i-r,0,s),d=c(o-r,0,h);for(let o=0;o<l;++o)for(let r=0;r<l;++r)f+=t[(o+y)*e+(r+d)]*n[o*l+r];a[i*e+o]=f}return a})(t,e,o,i,2,n),y=new Float32Array(256),d=new Float32Array(256);for(let t=0;t<256;++t){const e=Math.PI*t/256;y[t]=Math.cos(e),d[t]=Math.sin(e)}d[0]=y[128];const u=(t,e=new Float32Array(9))=>(e[0]=t[4]*t[8]-t[5]*t[7],e[1]=t[2]*t[7]-t[1]*t[8],e[2]=t[1]*t[5]-t[2]*t[4],e[3]=t[5]*t[6]-t[3]*t[8],e[4]=t[0]*t[8]-t[2]*t[6],e[5]=t[2]*t[3]-t[0]*t[5],e[6]=t[3]*t[7]-t[4]*t[6],e[7]=t[1]*t[6]-t[0]*t[7],e[8]=t[0]*t[4]-t[1]*t[3],e),g=(t,e,o=new Float32Array(9))=>(o[0]=t[0]*e[0]+t[1]*e[3]+t[2]*e[6],o[1]=t[0]*e[1]+t[1]*e[4]+t[2]*e[7],o[2]=t[0]*e[2]+t[1]*e[5]+t[2]*e[8],o[3]=t[3]*e[0]+t[4]*e[3]+t[5]*e[6],o[4]=t[3]*e[1]+t[4]*e[4]+t[5]*e[7],o[5]=t[3]*e[2]+t[4]*e[5]+t[5]*e[8],o[6]=t[6]*e[0]+t[7]*e[3]+t[8]*e[6],o[7]=t[6]*e[1]+t[7]*e[4]+t[8]*e[7],o[8]=t[6]*e[2]+t[7]*e[5]+t[8]*e[8],o),b=(t,e,o=new Float32Array(3))=>(o[0]=t[0]*e[0]+t[1]*e[1]+t[2]*e[2],o[1]=t[3]*e[0]+t[4]*e[1]+t[5]*e[2],o[2]=t[6]*e[0]+t[7]*e[1]+t[8]*e[2],o),x=({a:t,b:e,c:o,d:n})=>{const r=new Float32Array([t.x,e.x,o.x,t.y,e.y,o.y,1,1,1]),a=b(u(r),new Float32Array([n.x,n.y,1]));return g(r,new Float32Array([a[0],0,0,0,a[1],0,0,0,a[2]]))};const p=({a:t,b:e,c:o,d:n})=>Math.hypot(t.x-e.x,t.y-e.y)+Math.hypot(o.x-n.x,o.y-n.y)>Math.hypot(e.x-o.x,e.y-o.y)+Math.hypot(n.x-t.x,n.y-t.y)?t.x+e.x<o.x+n.x?t.y>e.y?{a:t,b:e,c:o,d:n}:{a:e,b:t,c:n,d:o}:o.y>n.y?{a:o,b:n,c:t,d:e}:{a:n,b:o,c:e,d:t}:e.x+o.x<n.x+t.x?e.y>o.y?{a:e,b:o,c:n,d:t}:{a:o,b:e,c:t,d:n}:n.y>t.y?{a:n,b:t,c:e,d:o}:{a:t,b:n,c:o,d:e},w=async t=>{const e=[];let o=0;const n=[],r=t=>{e.push(t),o+=t.length},l=t=>{r(" "),r(t)},s=t=>{let e=0;for(const o of t)e+=o.length;const o=new Uint8Array(e);e=0;for(const n of t){if("string"==typeof n)for(let t=0;t<n.length;++t)o[t+e]=n.charCodeAt(t);else o.set(n,e);e+=n.length}return o},c=t=>{r("%"+t+"\n")},h=t=>{l(t.toString())},i=t=>{l("/"+t)},f=t=>{l("["),t(),l("]")},y=t=>{l("<<");for(const e in t)i(e),t[e]();l(">>")},d=(t,e)=>{y(t),l("stream\n"),r(e),r("endstream")},u=t=>(r(" "),r(n.push(o)+" 0 obj"),t(),l("endobj"),n.length),g=t=>{l(t+" 0 R")};c("PDF-1.4"),c("úã");const b=await Promise.all(t.map((async t=>{const e=document.createElement("canvas");e.width=t.width,e.height=t.height,e.getContext("2d").putImageData(t,0,0);const o=await new Promise((t=>e.toBlob(t,"image/jpeg"))),r=new Uint8Array(await a.call(o)),l=u((()=>{d({Type(){i("XObject")},Subtype(){i("Image")},Width(){h(t.width)},Height(){h(t.height)},ColorSpace(){i("DeviceRGB")},BitsPerComponent(){h(8)},Filter(){i("DCTDecode")},Length(){h(r.length)}},r)})),c=792*t.width/t.height,b=u((()=>{const t=`${c} 0 0 792 0 0 cm /I Do`;d({Length(){h(t.length)}},s([t]))}));return u((()=>{y({Type(){i("Page")},Parent(){g(n.length+1)},Resources(){y({XObject(){y({I(){g(l)}})}})},Contents(){g(b)},MediaBox(){f((()=>{h(0),h(0),h(c),h(792)}))}})}))}))),x=u((()=>{y({Type(){i("Pages")},Kids(){f((()=>{for(const t of b)g(t)}))},Count(){h(b.length)}})})),p=u((()=>{y({Type(){i("Catalog")},Pages(){g(x)}})}));r("\n");const w=o;r("xref\n0 "+(n.length+1)+"\n0000000000 65535 f \n");for(const t of n)r(t.toString().padStart(10,"0")+" 00000 n \n");return r("trailer"),y({Size(){h(n.length+1)},Root(){g(p)}}),r("\nstartxref\n"+w+"\n%%EOF"),s(e)},m=({data:t,width:e,height:o},n=3)=>{console.time("document");const r=Math.hypot(e,o),a=Math.floor(r);let l=e/360;l<2?l=1:l>5&&(l=5);const s=Math.floor(e/l),c=Math.floor(o/l),i=s*c,u=new Float32Array(3*i+(a<<8)),g=u.subarray(0,i),b=u.subarray(i,i<<1),x=u.subarray(i<<1,3*i),w=u.subarray(3*i);1==l?h(t,x):((t,e,o,n,r)=>{const a=Math.floor(e/n),l=Math.floor(o/n);r||(r=new Float32Array(l*a));const s=n*n,c=l-1,h=a-1;for(let o=1;o<c;++o){const l=o*n,c=l+n,i=Math.floor(l),f=i+1,y=Math.floor(c),d=f-l,u=c-y;for(let l=1;l<h;++l){const c=l*n,h=c+n,g=Math.floor(c),b=g+1,x=Math.floor(h),p=b-c,w=h-x;let m=0;for(let o=f;o<y;++o)for(let n=b;n<x;++n)m+=t[o*e+n];for(let o=b;o<x;++o)m+=t[i*e+o]*d,m+=t[y*e+o]*u;for(let o=f;o<y;++o)m+=t[o*e+g]*p,m+=t[o*e+x]*w;m+=t[i*e+g]*d*p,m+=t[i*e+x]*d*w,m+=t[y*e+g]*u*p,m+=t[y*e+x]*u*w,r[o*a+l]=m/s}}for(let t=1;t<c;++t)r[t*a]=r[t*a+1],r[t*a+h]=r[t*a+h-1];for(let t=0;t<a;++t)r[t]=r[t+a],r[c*a+t]=r[(c-1)*a+t]})(h(t,new Float32Array(e*o)),e,o,l,x),console.timeLog("document","grayscale"),f(x,s,c,g),console.timeLog("document","blur");const m=s-1,M=s,v=s+1,L=c-1,A=s-1;let F=0;for(let t=1;t<L;++t)for(let e=1;e<A;++e){const o=t*s+e,n=g[o-v],a=g[o-M],l=g[o-m],c=g[o-1],h=g[o+1],i=g[o+m],f=g[o+M],u=g[o+v],x=10*(h-c)+3*(l+u-n-i),p=10*(a-f)+3*(l+n-u-i),L=p/x,A=Math.pow(x*x+p*p,.3),P=Math.floor(256*Math.atan(L)/Math.PI)+128;for(let o=-32;o<=32;++o){let n=P+o&255;w[(y[n]*t+d[n]*e+r>>1<<8)+n]+=A/(o*o+3)}b[o]=A,F+=A}const P=F/((c-2)*(s-2));console.timeLog("document","tally");let R=0;for(let t=0;t<w.length;++t)R=Math.max(w[t],R);console.timeLog("document","tally2");for(let t=.05*R,e=n;e>0;--e,t*=.5){let o=[];for(let e=0;e<a;++e)for(let n=0;n<256;++n){let r=w[(e<<8)+n];r>t&&o.push({b:e,a:n,s:r})}console.timeLog("document","tally3"),o.sort(((t,e)=>e.s-t.s));const n=Math.ceil(.025*a),h=Math.ceil(6.4);for(let t=0;t<o.length;++t){const{b:e,a:r,s:a}=o[t];let l=a;for(let a=t+1;a<o.length;++a){const{b:t,a:s,s:c}=o[a];let i=Math.abs(r-s);Math.abs(e-t)<=n&&Math.min(i,256-i)<=h&&(o.splice(a,1),l+=c,--a)}o[t].s=l}console.timeLog("document","hough");const i=(t,e)=>{const o=d[t.a],n=d[e.a],a=y[t.a],l=y[e.a],s=(t.b<<1)-r,c=(o*((e.b<<1)-r)-n*s)/(o*l-n*a);return{x:(s-c*a)/o,y:c}},f=t=>{const e=t.x/s-.5,o=t.y/c-.5;return e*e+o*o<=.55};o.sort(((t,e)=>e.s-t.s)),console.log(o),o.length>20&&(o=o.slice(0,20),e=1);const u=(t,e)=>{let o=0;const n=Math.round(t.x),r=Math.round(t.y),a=Math.round(e.x),l=Math.round(e.y),c=Math.abs(a-n),h=-Math.abs(l-r),i=n<a?1:-1,f=r<l?1:-1;for(let t=n,e=r,y=c+h;t!=a||e!=l;){o+=(b[e*s+t]||0)-P;const n=2*y;n>=h&&(y+=h,t+=i),n<=c&&(y+=c,e+=f)}return o*(Math.pow(c-h,-.6)||0)},g=({a:t,b:e,c:o,d:n})=>Math.pow(u(t,e)+u(e,o)+u(o,n)+u(n,t),2),x=(t,e)=>{const o=Math.abs(t.a-e.a)-128;return o*o+1},m=(t,e,o,n)=>{const r=x(t,e),a=x(e,o),l=x(o,n),s=x(n,t);return Math.pow(r*r+a*a+l*l+s*s,-.3)*Math.pow(t.s*e.s*o.s*n.s,.1)},M=[];for(let t=0;t<o.length;++t){const e=o[t];for(let n=t+1;n<o.length;++n){const t=o[n],r=i(e,t);for(let a=n+1;a<o.length;++a){const n=o[a],l=i(e,n),s=i(t,n);if(f(r)){if(f(l)){if(!f(s))for(let s=a+1;s<o.length;++s){const a=o[s],c=i(e,a),h=i(t,a),y=i(n,a);if(!f(c)&&f(h)&&f(y)){const o={a:r,b:l,c:y,d:h};M.push({q:o,s:g(o)*m(e,n,a,t)})}}}else if(f(s))for(let l=a+1;l<o.length;++l){const a=o[l],c=i(e,a),h=i(t,a),y=i(n,a);if(!f(h)&&f(c)&&f(y)){const o={a:r,b:s,c:y,d:c};M.push({q:o,s:g(o)*m(t,n,a,e)})}}}else if(f(l)&&f(s))for(let r=a+1;r<o.length;++r){const a=o[r],c=i(e,a),h=i(t,a);if(!f(i(n,a))&&f(c)&&f(h)){const o={a:l,b:s,c:h,d:c};M.push({q:o,s:g(o)*m(n,t,a,e)})}}}}}if(console.timeLog("document","rects"),M.sort(((t,e)=>e.s-t.s)),console.log(M),!M.length)continue;const v=p(M[0].q);return console.timeEnd("document"),{a:{x:v.a.x*l,y:v.a.y*l},b:{x:v.b.x*l,y:v.b.y*l},c:{x:v.c.x*l,y:v.c.y*l},d:{x:v.d.x*l,y:v.d.y*l}}}},M=({data:t,width:e,height:o},n)=>{const r=Math.floor(Math.max(Math.hypot(n.a.x-n.b.x,n.a.y-n.b.y)+Math.hypot(n.c.x-n.d.x,n.c.y-n.d.y))/2),a=(Math.floor((Math.hypot(n.a.x-n.d.x,n.a.y-n.d.y)+Math.hypot(n.b.x-n.c.x,n.b.y-n.c.y))/2),Math.min(r,1584)),l=Math.floor(8.5/11*a),s=((t,e)=>{const o=x(t),n=x(e),r=g(n,u(o));return t=>{const e=b(r,new Float32Array([t.x,t.y,1]));return{x:e[0]/e[2],y:e[1]/e[2]}}})({a:{x:0,y:a},b:{x:0,y:0},c:{x:l,y:0},d:{x:l,y:a}},n),c=new Uint8ClampedArray(l*a*4),h=e<<2,i=h+4;for(let n=0;n<a;++n)for(let r=0;r<l;++r){const a=s({x:r,y:n}),f=Math.floor(a.x),y=Math.floor(a.y),d=4*(n*l+r);if(c[d+3]=255,f>=-1&&f<e&&y>=-1&&y<o){const o=a.x-f,n=1-o,r=a.y-y,l=1-r,s=4*(y*e+f);for(let e=0;e<3;++e){const a=s+e;let f=t[a]*n+t[a+4]*o,y=t[a+h]*n+t[a+i]*o;c[d+e]=f*l+y*r}}}return new ImageData(c,l,a)},v=document.getElementById("img-input"),L=document.getElementById("done"),A=[];v.addEventListener("change",(async()=>{const t=await(async t=>{const e=document.createElement("img"),o=new Promise(((t,o)=>{e.onload=()=>{t()},e.onerror=t=>{o(t)}}));return e.src=URL.createObjectURL(t),await o,URL.revokeObjectURL(e.src),l.width=e.width,l.height=e.height,s.drawImage(e,0,0),s.getImageData(0,0,e.width,e.height)})(v.files[0]);let e=m(t);e&&A.push(M(t,e))})),L.addEventListener("click",(async()=>{((t,e)=>{const o=URL.createObjectURL(t),n=document.createElement("a");n.download=e,n.href=o,n.click(),URL.revokeObjectURL(o)})(new Blob([await w(A)]),"out.pdf")}));var F;r.register("kPq84",(function(e,o){var n;t(e.exports,"getBundleURL",(()=>n),(t=>n=t));var r={};function a(t){return(""+t).replace(/^((?:https?|file|ftp):\/\/.+)\/[^/]+$/,"$1")+"/"}n=function(t){var e=r[t];return e||(e=function(){try{throw new Error}catch(e){var t=(""+e.stack).match(/(https?|file|ftp):\/\/[^)\n]+/g);if(t)return a(t[2])}return"/"}(),r[t]=e),e}})),F=r("kPq84").getBundleURL("lNt4Y")+r("bXuNP").resolve("4euQ1"),navigator.serviceWorker.register(F);
//# sourceMappingURL=index.3bdec287.js.map
